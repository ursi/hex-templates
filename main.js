(()=>{function*Qn(t,e){for(let n=t;n<e;n++)yield n}function u(){throw new Error("Failed pattern match")}function Jo(t,e){return e>0?Math.floor(t/e):e<0?-Math.floor(t/-e):0}var jt=t=>e=>t;var le=t=>e=>e(t);var Yn={compose:t=>e=>n=>t(e(n))};var rl=()=>({}),V=rl();var O=function(t){return function(e){for(var n=e.length,r=new Array(n),o=0;o<n;o++)r[o]=t(e[o]);return r}};var Ee=t=>t;var Xt=function(t){return function(e){return e[t]}};var gt=function(t){return t.toString()},kt=function(t){var e=t.toString();return isNaN(e+".0")?e:e+".0"},bn=function(t){var e=t.charCodeAt(0);if(e<32||e===127){switch(t){case"\x07":return"'\\a'";case"\b":return"'\\b'";case"\f":return"'\\f'";case`
`:return"'\\n'";case"\r":return"'\\r'";case"	":return"'\\t'";case"\v":return"'\\v'"}return"'\\"+e.toString(10)+"'"}return t==="'"||t==="\\"?"'\\"+t+"'":"'"+t+"'"};var Qo=t=>t,et=Qo(0),nt=Qo(1),Rt=Qo(2);var m=(t,e)=>({tag:t,_1:e}),$=m(0),A=t=>m(1,t);var vr=t=>{if(t.tag===0)return!0;if(t.tag===1)return!1;u()};var l=(t,e)=>({tag:t,_1:e}),Zn=t=>l(0,t),ge=t=>l(1,t);var Br={map:t=>e=>{if(e.tag===0)return l(0,e._1);if(e.tag===1)return l(1,t(e._1));u()}};var Gi={apply:t=>e=>{if(t.tag===0)return l(0,t._1);if(t.tag===1){if(e.tag===0)return l(0,e._1);if(e.tag===1)return l(1,t._1(e._1))}u()},Functor0:()=>Br},il={bind:t=>{if(t.tag===0){let e=t._1;return n=>l(0,e)}if(t.tag===1){let e=t._1;return n=>n(e)}u()},Apply0:()=>Gi};var ul={pure:ge,Apply0:()=>Gi},Yo={Applicative0:()=>ul,Bind1:()=>il};var Ji=function(t){return function(){return t}},Qi=function(t){return function(e){return function(){return e(t())()}}},Yi=function(t){return function(){for(;!t(););}};var Vr={Applicative0:()=>De,Bind1:()=>Ki},Ki={bind:Qi,Apply0:()=>Zi},Zi={apply:t=>e=>()=>{let n=t(),r=e();return De.pure(n(r))()},Functor0:()=>sl},De={pure:Ji,Apply0:()=>Zi},sl={map:t=>e=>()=>{let n=e();return t(n)}};function Re(t){return new Error(t)}function We(t){return function(){throw t}}var dl={throwError:Zn,Monad0:()=>Yo};var Xe={catchError:t=>e=>{if(t.tag===0)return e(t._1);if(t.tag===1)return l(1,t._1);u()},MonadThrow0:()=>dl};var Xo=typeof Array.prototype.flatMap=="function"?function(t){return function(e){return t.flatMap(e)}}:function(t){return function(e){for(var n=[],r=t.length,o=0;o<r;o++)for(var a=e(t[o]),i=a.length,s=0;s<i;s++)n.push(a[s]);return n}};var Tt=(t,e)=>({tag:t,_1:e}),na=t=>Tt(0,t);var ru={tailRecM:t=>e=>{let n=t(e);return()=>{let o=n();Yi(()=>{let i=o;if(i.tag===0)return o=t(i._1)(),!1;if(i.tag===1)return!0;u()})();let a=o;if(a.tag===1)return a._1;u()}},Monad0:()=>Vr};var ou=function(t){return function(e){return function(){return t(e())}}},au=function(t){return function(){return t}};var fl={map:ou};var pl={apply:t=>e=>()=>{let n=t(),r=e();return xn.pure(n(r))()},Functor0:()=>fl},xn={pure:au,Apply0:()=>pl};var iu=function(e){return function(n){return function(r){return function(){return e(n,r)}}}};var uu=function(e){return function(n){return function(r){return function(o){return function(a){return function(){return e(n,r,o,a)}}}}}};var Tn=function(t){return t.length};var du=function(t,e,n,r){return r.splice.apply(r,[t,e].concat(n))};var cu=function(t,e){return e.push(t)};var er=uu(du);var lu=iu(cu);var ht=function(t){return function(e){return function(n){for(var r=e,o=n.length,a=o-1;a>=0;a--)r=t(n[a])(r);return r}}},Ct=function(t){return function(e){return function(n){for(var r=e,o=n.length,a=0;a<o;a++)r=t(r)(n[a]);return r}}};var Oe=t=>{let e=t.Apply0();return n=>r=>n.foldr(o=>{let a=r(o);return i=>e.apply(e.Functor0().map(s=>Ee)(a))(i)})(t.pure())},Ue=t=>{let e=Oe(t);return n=>{let r=e(n);return o=>a=>r(a)(o)}};var te={foldr:t=>e=>n=>{if(n.tag===0)return e;if(n.tag===1)return t(n._1)(e);u()},foldl:t=>e=>n=>{if(n.tag===0)return e;if(n.tag===1)return t(e)(n._1);u()},foldMap:t=>{let e=t.mempty;return n=>r=>{if(r.tag===0)return e;if(r.tag===1)return n(r._1);u()}}};var Gt={foldr:ht,foldl:Ct,foldMap:t=>{let e=t.mempty;return n=>Gt.foldr(r=>o=>t.Semigroup0().append(n(r))(o))(e)}};var _=(t,e)=>({_1:t,_2:e}),Wt=t=>e=>_(t,e);var Jt=t=>t._2;var ye=t=>t._1;var tn=function(t){return function(e){for(var n=e.length,r=Array(n),o=0;o<n;o++)r[o]=t(o)(e[o]);return r}};var hu=function(t){return function(e){return t===e}};var bu=hu,Mu=hu;var ia={eq:Mu},rr={eq:bu};var Eu=function(t){return function(e){return function(n){return function(r){return function(o){return r<o?t:r===o?e:n}}}}};var xu=Eu,Tu=Eu;var or={compare:Tu(et)(Rt)(nt),Eq0:()=>ia},ot={compare:xu(et)(Rt)(nt),Eq0:()=>rr};var ve=function(t,e){for(var n=t>e?-1:1,r=new Array(n*(e-t)+1),o=t,a=0;o!==e;)r[a++]=o,o+=n;return r[a]=o,r},Kl=function(t,e){if(t<1)return[];var n=new Array(t);return n.fill(e)},Zl=function(t,e){for(var n=[],r=0,o=0;o<t;o++)n[r++]=e;return n},Ru=typeof Array.prototype.fill=="function"?Kl:Zl,qt=function(){function t(o,a){this.head=o,this.tail=a}var e={};function n(o){return function(a){return new t(o,a)}}function r(o){for(var a=[],i=0,s=o;s!==e;)a[i++]=s.head,s=s.tail;return a}return function(o,a){return r(o(n)(e)(a))}}();var ar=function(t,e,n){return n.length===0?t({}):e(n[0])(n.slice(1))};var ir=function(t,e){return e.filter(t)};var Wu=function(){function t(e,n,r,o,a,i){var s,d,f,c,p,g,y;for(s=a+(i-a>>1),s-a>1&&t(e,n,o,r,a,s),i-s>1&&t(e,n,o,r,s,i),d=a,f=s,c=a;d<s&&f<i;)p=o[d],g=o[f],y=n(e(p)(g)),y>0?(r[c++]=g,++f):(r[c++]=p,++d);for(;d<s;)r[c++]=o[d++];for(;f<i;)r[c++]=o[f++]}return function(e,n,r){var o;return r.length<2?r:(o=r.slice(0),t(e,n,o,r.slice(0),0,r.length),o)}}();var ur=t=>e=>Wu(t,n=>{if(n===1)return 1;if(n===2)return 0;if(n===0)return-1;u()},e),ua=t=>e=>ur(n=>r=>t.compare(e(n))(e(r)));var ee=t=>e=>(()=>{let n=lu(e);return()=>{let r=[...t];return n(r)(),r}})()();var Qt=t=>{let e=t.length-1|0;return e>=0&&e<t.length?m(1,t[e]):$};var Jr=t=>e=>{let n=ur(r=>o=>t(r._2)(o._2))(tn(Wt)(e));return 0<n.length?O(Jt)(ua(ot)(ye)((()=>{let r=[n[0]];for(let o of n){let a=t((()=>{let i=Qt(r);if(i.tag===1)return i._1._2;u()})())(o._2);(a===0||a===1||a!==2)&&r.push(o)}return r})())):[]};var sa=function(t){return function(e){return t.length===0?e:e.length===0?t:t.concat(e)}};var sr={append:sa};var da=t=>t;var Hu=function(t){return function(e){return function(n){return function(r){return function(o){return function(a){for(var i=[],s=a;;){var d=o(s);i.push(n(d));var f=r(d);if(t(f))return i;s=e(f)}}}}}}};var E$=t=>{if(t.tag===1)return t._1;u()};var la={unfoldr1:Hu(vr)(E$)(ye)(Jt)};var vu=function(t,e){for(var n=e[e.length-1],r=e.length-2;r>=0;r--)n=t(e[r])(n);return n},Bu=function(t,e){for(var n=e[0],r=e.length,o=1;o<r;o++)n=t(n)(e[o]);return n};var Fn={foldMap1:t=>{let e=t.append;return n=>{let r=O(n),o=Fn.foldl1(e);return a=>o(r(a))}},foldr1:t=>e=>vu(t,e),foldl1:t=>e=>Bu(t,e),Foldable0:()=>Gt};var zu=function(t){return function(e){return t+e}},ju=function(t){return function(e){return t*e}};var Kr={add:zu,zero:0,mul:ju,one:1};var Ju=function(t){return function(e){return t-e}};var fa={sub:Ju,Semiring0:()=>Kr};var nn=function(t){return function(e){if(t>=0&&t<e.length)return e.charAt(t);throw new Error("Data.String.Unsafe.charAt: Invalid index.")}};var U=function(t){return t},Ku=function(t){return function(e){return function(n){return function(r){return n>=0&&n<r.length?t(r.charAt(n)):e}}}};var rn=function(t){return t.length};var Zu=function(t){return function(e){return function(n){return function(r){var o=r.indexOf(n);return o===-1?e:t(o)}}}};var Be=function(t){return function(e){return e.substring(t)}};var Xu=Zu(A)($);var pa=t=>{let e=Xu(t);return n=>{let r=e(n);if(r.tag===0)return!1;if(r.tag===1)return!0;u()}},ts=Ku(A)($);var ue=(t,e)=>({_1:t,_2:e});var es=t=>{let e={foldMap:n=>{let r=t.foldMap(n);return o=>a=>n.Semigroup0().append(o(a._1))(r(o)(a._2))},foldl:n=>r=>o=>t.foldl(n)(n(r)(o._1))(o._2),foldr:n=>r=>o=>n(o._1)(t.foldr(n)(r)(o._2))};return{foldMap1:n=>r=>o=>t.foldl(a=>i=>n.append(a)(r(i)))(r(o._1))(o._2),foldr1:n=>r=>{let o=n(r._1),a=t.foldr(i=>{let s=n(i);return d=>m(1,(()=>{if(d.tag===0)return i;if(d.tag===1)return s(d._1);u()})())})($)(r._2);if(a.tag===0)return r._1;if(a.tag===1)return o(a._1);u()},foldl1:n=>r=>t.foldl(n)(r._1)(r._2),Foldable0:()=>e}};var G=(t,e,n)=>({tag:t,_1:e,_2:n});var X=G(0);var se={foldr:t=>e=>{let n=se.foldl(a=>i=>t(i)(a))(e),o=(a=>i=>{let s=a,d=i,f=!0,c;for(;f;){let p=s,g=d;if(g.tag===0){f=!1,c=p;continue}if(g.tag===1){s=G(1,g._1,p),d=g._2;continue}u()}return c})(X);return a=>n(o(a))},foldl:t=>n=>r=>{let o=n,a=r,i=!0,s;for(;i;){let d=o,f=a;if(f.tag===0){i=!1,s=d;continue}if(f.tag===1){o=t(d)(f._1),a=f._2;continue}u()}return s},foldMap:t=>{let e=t.mempty;return n=>se.foldl(r=>{let o=t.Semigroup0().append(r);return a=>o(n(a))})(e)}};var Zr=es(se);var ma=Math.cos;var on=function(t){return t};var k$=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};var lr=function(t){return function(e){if(e===0)return 0;var n=Math.abs(e);return(t%n+n)%n}};var cs=function(t){return function(e){return function(n){return function(r){return function(o){return function(a){for(var i=[],s=a;;){var d=o(s);if(t(d))return i;var f=e(d);i.push(n(f)),s=r(f)}}}}}}};var V$=t=>{if(t.tag===1)return t._1;u()};var an={unfoldr:cs(vr)(V$)(ye)(Jt),Unfoldable10:()=>la};function tt(t,e,n){return t==null?e:n(t)}function _a(t){return function(e){var n=[];for(var r in e)hasOwnProperty.call(e,r)&&n.push(t(r)(e[r]));return n}}var Bb=Object.keys||_a(function(t){return function(){return t}});function ha(t){var e={};for(var n in t)({}).hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}function Pn(t){return function(e){return function(n){return n[t]=e,n}}}function Ds(t){return function(e){return function(n){return n[t]=e(n[t]),n}}}var ys=()=>()=>t=>e=>n=>r=>Ds(t.reflectSymbol(e))(n)(r);var je=(t,e)=>({tag:t,_1:e}),$r=(t,e,n)=>({tag:t,_1:e,_2:n});var Ma=$r(4);var hs=je(0,{rep:"",lineage:Ma,hasElementParent:!1});var Ea=t=>{if(t.tag===0)return t._1.hasElementParent;if(t.tag===1)return pa("e")(t._1.rep);u()},ro=t=>e=>{if(e.tag===0)return je(0,{rep:e._1.rep+"f"+gt(t),lineage:$r(3,t,e._1.lineage),hasElementParent:e._1.hasElementParent});if(e.tag===1)return je(1,{rep:e._1.rep+"f"+gt(t)});u()},bs=t=>e=>{if(e.tag===0)return je(0,{rep:e._1.rep+"e"+gt(t),lineage:$r(0,t,e._1.lineage),hasElementParent:!0});if(e.tag===1)return je(1,{rep:e._1.rep+"e"+gt(t)});u()},Ms=t=>e=>{if(e.tag===0)return je(0,{rep:e._1.rep+"d"+gt(t),lineage:$r(1,t,e._1.lineage),hasElementParent:!1});if(e.tag===1)return je(1,{rep:e._1.rep+"d"+gt(t)});u()};var pr=(e=>n=>{let r=e,o=n,a=!0,i;for(;a;){let s=r,d=o;if(d.tag===0){a=!1,i=s;continue}if(d.tag===1){r=G(1,d._1,s),o=d._2;continue}u()}return i})(X);var xs=t=>e=>{let n=e.Plus1().Alt0(),r=e.Applicative0();return o=>t.tailRecM(a=>t.Monad0().Bind1().bind(n.alt(n.Functor0().map(na)(o))(r.pure(Tt(1,void 0))))(i=>r.pure((()=>{if(i.tag===0)return Tt(0,G(1,i._1,a));if(i.tag===1)return Tt(1,pr(a));u()})())))(X)};var sn=(t,e)=>({_1:t,_2:e});var Ts=t=>{let e=t,n=!0,r;for(;n;){let o=e;if(o._1.tag===0){if(o._2.tag===0){n=!1,r=$;continue}e=sn(pr(o._2),X);continue}if(o._1.tag===1){n=!1,r=m(1,_(o._1._1,sn(o._1._2,o._2)));continue}u()}return r};var mr=(t,e,n)=>({tag:t,_1:e,_2:n}),Pt=mr(0);var ff=t=>e=>{if(t.tag===0)return e;if(e.tag===0)return t;if(t.tag===1)return mr(1,t._1,sn(t._2._1,G(1,e,t._2._2)));u()},pf=t=>e=>n=>{let r=a=>i=>s=>{let d=a,f=i,c=s,p=!0,g;for(;p;){let y=d,E=f,I=c;if(I.tag===0){p=!1,g=E;continue}if(I.tag===1){d=y,f=y(E)(I._1),c=I._2;continue}u()}return g};return(a=>i=>{let s=a,d=i,f=!0,c;for(;f;){let p=s,g=d,y=Ts(p);if(y.tag===0){f=!1,c=r(E=>I=>I(E))(e)(g);continue}if(y.tag===1){s=y._1._2,d=G(1,t(y._1._1),g);continue}u()}return c})(n)(X)},Fs=t=>{if(t.tag===0)return $;if(t.tag===1)return m(1,_(t._1,t._2._1.tag===0&&t._2._2.tag===0?Pt:pf(ff)(Pt)(t._2)));u()};var Ut=(t,e)=>({_1:t,_2:e}),Ht=(t,e,n)=>({tag:t,_1:e,_2:n});var gf=t=>{let e=t,n=!0,r;for(;n;){let o=e;if(o._1.tag===0){let a=Fs(o._2);if(a.tag===0){n=!1,r=Ht(0,o._1._1);continue}if(a.tag===1){e=(()=>{let i=a._1._1(o._1._1);return Ut(i._1,(()=>{if(i._2.tag===0)return a._1._2;if(a._1._2.tag===0)return i._2;if(i._2.tag===1)return mr(1,i._2._1,sn(i._2._2._1,G(1,a._1._2,i._2._2._2)));u()})())})();continue}u()}if(o._1.tag===1){n=!1,r=Ht(1,o._1._1,a=>{let i=o._1._2(a);return Ut(i._1,(()=>{if(i._2.tag===0)return o._2;if(o._2.tag===0)return i._2;if(i._2.tag===1)return mr(1,i._2._1,sn(i._2._2._1,G(1,o._2,i._2._2._2)));u()})())});continue}u()}return r};var Df=t=>e=>n=>{let r=gf(n);if(r.tag===0)return e(r._1);if(r.tag===1)return t(r._1)(r._2);u()},Is=t=>Df(e=>n=>l(0,t.map(n)(e)))(ge);var Ns=t=>e=>n=>t.sampleOnRight(e)(t.Filterable2().Functor1().map(le)(n));var Ca=t=>{for(var e=0,n=t.length;e<n;e++)t[e]()},Ne=(t,e)=>{for(var n=0,r=t.length;n<r;n++)e(t[n])},ks=t=>()=>({r:!1,q:[],m:[{}],tag:t}),Ps=(t,e,n)=>{n.m[n.m.length-1][t]=e},Ss=(t,e)=>{for(let n of e.m)if(delete n[t])return!0;return!1},As=(t,e,n,r)=>{t.m.push({});for(let o of Object.entries(t.m[r])){let a=o[0],i=o[1];n(i),Object.keys(t.m[r+1]).length&&As(t,e,n,r+1),t.m[r+1]={},t.m.length=r+1+1,e[a]=i}},Ls=(t,e)=>{let n=e;for(;;){if(t.r){t.q.push(n);return}t.r=!0;let r={};if(As(t,r,n,0),t.m.length=0,t.m.push(r),t.r=!1,n=t.q.shift(),n==null)break}};var ao=Ue(De)(te),_f=Is({map:t=>e=>()=>{let n=e();return _(n._1,t(n._2))}}),hf=t=>{};var Ia=(t,e)=>t(e);var Ws=t=>e=>n=>{let r=$,o=t(i=>{r=m(1,i)}),a=e(i=>ao(r)(d=>{let f=i(d);return()=>n(f)})());return()=>(o(),a())},Ln=t=>e=>n=>{let r=$,o=t(i=>ao(r)(d=>{let f=d(i);return()=>n(f)})()),a=e(i=>{r=m(1,i)});return()=>(o(),a())},io=t=>e=>{let n=$,r=()=>{},o=t(i=>{let s=n;if(s.tag===0)return n=m(1,i),e(i),r();s.tag!==1&&u()});return r=o,n.tag===1&&o(),o},dn=t=>e=>t(n=>r=>()=>n(o=>ru.tailRecM(a=>{let i=_f(a);if(i.tag===1)return()=>Tt(1,void 0);if(i.tag===0){let s=i._1;return()=>{let d=s();return Ne(d._1,e),Tt(0,d._2)}}u()})(r(o))()))();var bf=t=>e=>{let n=()=>{},r=t(o=>{n(),n=o(e)});return()=>(n(),r())},qs=t=>Ut(Ht(1,()=>{let e=t();return _([e],void 0)},e=>Ut(Ht(0,e),Pt)),Pt),Na=t=>Ut(Ht(1,()=>_([t],void 0),e=>Ut(Ht(0,e),Pt)),Pt);var cn={map:t=>e=>n=>e(r=>{let o=t(r);return n(o)})};var Mf=t=>e=>n=>e(r=>{let o=t(r);if(o.tag===1){let a=o._1;return n(a)}o.tag!==0&&u()}),Ef=t=>e=>n=>e(r=>{if(t(r))return n(r)});var uo=t=>e=>{let n=[];return Ne(t,r=>{let o=r(e);n.push(o)}),()=>{let r=[...n];return Ca(r)}},Os=t=>e=>n=>{let r=[];return Ne(e,o=>{let i=t(o)(n);r.push(i)}),()=>{let o=[...r];return Ca(o)}},ka=t=>{let e=ks(t);return()=>{let n=e(),r=0;return{event:o=>{let a={value:o},i=r;return Ps(i,a,n),r=r+1|0,()=>{a.value=hf,Ss(i,n)}},push:o=>()=>Ls(n,a=>{let i=a.value;return i(o)})}}};var wn=ka(""),he=ka(""),Us=t=>e=>{let n=he(),r=n.event(e),o=t(n.event)(a=>n.push(a)());return()=>(o(),r())};var Hs=t=>()=>{let e=he(),n=t(r=>e.push(r)());return{event:e.event,unsubscribe:n}},vs={compact:t=>e=>t(n=>{if(n.tag===1){let r=n._1;return e(r)}n.tag!==0&&u()}),separate:t=>({left:e=>t(n=>{if(n.tag===0){let r=n._1;return e(r)}n.tag!==1&&u()}),right:e=>t(n=>{if(n.tag===1){let r=n._1;return e(r)}n.tag!==0&&u()})})},Fa={filter:Ef,filterMap:Mf,partition:t=>e=>({yes:n=>e(r=>{if(t(r))return n(r)}),no:n=>e(r=>{if(!t(r))return n(r)})}),partitionMap:t=>e=>({left:Fa.filterMap(n=>{let r=t(n);if(r.tag===0)return m(1,r._1);if(r.tag===1)return $;u()})(e),right:Fa.filterMap(n=>{let r=t(n);if(r.tag===0)return $;if(r.tag===1)return m(1,r._1);u()})(e)}),Compactable0:()=>vs,Functor1:()=>cn},xf=t=>e=>n=>{let r=$,o=$,a=t(s=>(r=m(1,s),ao(o)(f=>{let c=f(s);return()=>n(c)})())),i=e(s=>(o=m(1,s),ao(r)(f=>{let c=s(f);return()=>n(c)})()));return()=>(a(),i())},so={apply:t=>e=>xf(t)(n=>e(r=>n(le(r)))),Functor0:()=>cn};var Bs={alt:t=>e=>n=>{let r=t(n),o=e(n);return()=>(r(),o())},Functor0:()=>cn},co={empty:t=>()=>{},Alt0:()=>Bs},lo={keepLatest:bf,sampleOnRight:Ws,sampleOnLeft:Ln,fix:Us,once:io,Plus0:()=>co,Alt1:()=>Bs,Filterable2:()=>Fa};var Aa=t=>e=>t(e)?m(1,e):$;var La=function(){return window};function ln(t,e,n,r){if(typeof window<"u"){var o=window[n];if(o!=null&&r instanceof o)return e(r)}for(var a=r;a!=null;){var i=Object.getPrototypeOf(a),s=i.constructor.name;if(s===n)return e(r);if(s==="Object")return t;a=i}return t}var dt=t=>e=>ln($,A,t,e);function Qs(t){return function(){return t.document}}var Zs=(t,e,n)=>({tag:t,_1:e,_2:n}),wa=t=>t;var Lf=t=>e=>Zs(0,t,e);var wf={sample:t=>e=>t(e)};var Wa=t=>e=>dn(n=>n(e)(r=>qs(()=>{let o=t.value;return r(o)})));var $o=t=>e=>Os(n=>n(e))(t);var be=t=>e=>n=>r=>o=>a=>t.sample(i=>o(e.map(s=>d=>s(r(d)))(i)))(n.map(le)(a));var Rf=t=>{let e=t.Functor1();return n=>{let r=n.Plus0(),o=ht(r.Alt0().alt)(r.empty);return a=>i=>s=>t.filterMap(d=>d.tag===1?m(1,d._1):$)(n.fix(d=>o([be(a)(e)(e)(Lf)(i)(s),n.keepLatest(t.filterMap(f=>f.tag===0?m(1,be(a)(e)(e)(c=>p=>Zs(1,f._2(c)))(f._1)(n.once(d))):$)(d))])))}};var Xs=t=>()=>{let e=wn(),n=!1,r=()=>{};return{unsubscribe:()=>r(),poll:o=>dn(a=>()=>{let i=n,s=a(be(wf)(cn)(cn)(jt)(t)(io(o)))(d=>{let f=e.push(d);return Ut(Ht(1,()=>{let c=f();return _([],c)},c=>Ut(Ht(0,c),Pt)),Pt)});if(!i){let d=s();n=!0,r=d}return a(Ns(lo)(o)(e.event))(Na)()})}},Wf=t=>e=>{let n=e.Filterable2().Functor1();return r=>o=>a=>e.sampleOnLeft(be(t)(n)(n)(jt)(r)(a))(be(t)(n)(n)(i=>s=>d=>s(i(d)))(o)(a))},qf=t=>e=>{let n=e.Filterable2().Functor1();return r=>o=>a=>e.sampleOnRight(be(t)(n)(n)(jt)(r)(a))(be(t)(n)(n)(i=>s=>d=>s(i(d)))(o)(a))};var Of=t=>e=>{let n=e.Filterable2().Functor1();return r=>o=>n.map(a=>a._2(a._1))(e.fix(a=>be(t)(n)(n)(Wt)(r((()=>{let i=n.map(ye)(a);return s=>e.sampleOnLeft(i)(s)})()))(o)))},Dr=t=>e=>n=>r=>o=>a=>t.compact(be(e)(n)(n)(i=>s=>{let d=r(i);return d.tag===1?m(1,s(d._1)):$})(o)(a)),Ra=t=>e=>n=>r=>o=>{let a=i=>o(n.map(s=>d=>s(r(d)))(i));return{left:Dr(e)(t)(n)(i=>{if(i.tag===0)return m(1,i._1);if(i.tag===1)return $;u()})(a),right:Dr(e)(t)(n)(i=>{if(i.tag===0)return $;if(i.tag===1)return m(1,i._1);u()})(a)}},Uf=t=>e=>n=>({compact:Dr(e)(n)(t)(wa),separate:Ra(n)(e)(t)(wa)}),td=t=>{let e={map:n=>r=>o=>r(t.map(a=>i=>a(n(i)))(o))};return n=>r=>{let o=Uf(t)(n)(r);return{filterMap:Dr(n)(r)(t),filter:a=>Dr(n)(r)(t)(Aa(a)),partitionMap:Ra(r)(n)(t),partition:a=>i=>{let s=Ra(r)(n)(t)(d=>a(d)?l(1,d):l(0,d))(i);return{no:s.left,yes:s.right}},Compactable0:()=>o,Functor1:()=>e}}},ed=t=>{let e=t.Filterable2(),n=Rf(e)(t),r=t.Plus0(),o=r.empty,a=(()=>{let c=r.Alt0(),p=c.Functor0(),g={map:E=>I=>R=>I(p.map(w=>Y=>w(E(Y)))(R))},y={alt:E=>I=>R=>c.alt(E(R))(I(R)),Functor0:()=>g};return{empty:E=>o,Alt0:()=>y}})(),i=t.Alt1(),s=i.Functor0(),d=(()=>{let c={map:p=>g=>y=>g(s.map(E=>I=>E(p(I)))(y))};return{alt:p=>g=>y=>i.alt(p(y))(g(y)),Functor0:()=>c}})(),f=td(e.Functor1())(e.Compactable0());return c=>p=>{let g=f(p);return{sampleOnRight:qf(p)(t),sampleOnLeft:Wf(p)(t),keepLatest:n(p),fix:Of(p)(t),once:y=>E=>t.once(p.sample(y)(E)),Plus0:()=>a,Alt1:()=>d,Filterable2:()=>g}}};var qa=t=>{let e=t.Functor0(),n={map:r=>o=>a=>o(e.map(i=>s=>i(r(s)))(a))};return{apply:r=>o=>a=>t.apply(e.map(i=>s=>s._1(i(s._2)))(r(e.map(i=>wa)(a))))(o(e.map(Wt)(a))),Functor0:()=>n}};var nd=t=>{let e=qa(t);return{pure:n=>r=>t.Functor0().map(le(n))(r),Apply0:()=>e}};var h=(t,e,n)=>({tag:t,_1:e,_2:n}),vf={sample:t=>e=>t(e)},Ua=t=>ht(e=>{let n=t(e);return r=>o=>{let a=n(o),i=r(o);return s=>{let d=a(s),f=i(s);return()=>(d(),f())}}})(e=>co.empty),Ha=nd(so).pure,ne=t=>e=>Ln(t)(e);var va=ed(lo)(co)(vf);var Bf=qa(so).apply;var rd={sample:t=>e=>{if(t.tag===4){let n=t._1,r=dn(a=>a(e)(i=>{let s=O(i)(n);return Ut(Ht(1,()=>_(s,void 0),d=>Ut(Ht(0,d),Pt)),Pt)})),o=t._2(e);return a=>{let i=r(a),s=o(a);return()=>(i(),s())}}if(t.tag===3){let n=t._1,r=dn(o=>o(e)(a=>{let i=O(a)(n);return Ut(Ht(1,()=>_(i,void 0),s=>Ut(Ht(0,s),Pt)),Pt)}));return o=>{let a=r(o),i=Ln(t._2)(e)(o);return()=>(a(),i())}}if(t.tag===2)return Ln(t._1)(e);if(t.tag===1)return t._1(e);if(t.tag===0){let n=t._1;return dn(r=>r(e)(o=>{let a=O(o)(n);return Ut(Ht(1,()=>_(a,void 0),i=>Ut(Ht(0,i),Pt)),Pt)}))}u()}},yr=t=>{if(t.tag===4){let e=Ua(Ha)(t._1);return n=>{let r=e(n),o=t._2(n);return a=>{let i=r(a),s=o(a);return()=>(i(),s())}}}if(t.tag===3){let e=Ua(Ha)(t._1);return n=>{let r=e(n);return o=>{let a=r(o),i=ne(t._2)(n)(o);return()=>(a(),i())}}}if(t.tag===2)return ne(t._1);if(t.tag===0)return Ua(Ha)(t._1);if(t.tag===1)return t._1;u()};var Ba=t=>{let e=ht(n=>r=>{if(n.tag===0)return{l:[...n._1,...r.l],m:r.m,r:r.r};if(n.tag===2)return{l:r.l,m:[n._1,...r.m],r:r.r};if(n.tag===3)return{l:[...n._1,...r.l],m:[n._2,...r.m],r:r.r};if(n.tag===1)return{l:r.l,m:r.m,r:[n._1,...r.r]};if(n.tag===4)return{l:[...n._1,...r.l],m:r.m,r:[n._2,...r.r]};u()})({l:[],m:[],r:[]})(t);return e.r.length===0?e.m.length===0?h(0,e.l):e.l.length===0?h(2,uo(e.m)):h(4,e.l,n=>r=>{let o=ne(uo(e.m))(n)(r),a=$o(e.r)(n)(r);return()=>(o(),a())}):e.l.length===0&&e.m.length===0?h(1,$o(e.r)):h(4,e.l,n=>r=>{let o=ne(uo(e.m))(n)(r),a=$o(e.r)(n)(r);return()=>(o(),a())})};var z={map:t=>e=>{if(e.tag===4)return h(4,O(t)(e._1),n=>e._2(r=>n(o=>r(a=>o(t(a))))));if(e.tag===3)return h(3,O(t)(e._1),n=>e._2(r=>{let o=t(r);return n(o)}));if(e.tag===0)return h(0,O(t)(e._1));if(e.tag===2)return h(2,n=>e._1(r=>{let o=t(r);return n(o)}));if(e.tag===1)return h(1,n=>e._1(r=>n(o=>r(a=>o(t(a))))));u()}};var fo={alt:t=>e=>{if(t.tag===0){if(e.tag===0)return h(0,[...t._1,...e._1]);if(e.tag===2)return h(3,t._1,e._1);if(e.tag===1)return h(4,t._1,e._1);if(e.tag===3)return h(3,[...t._1,...e._1],e._2);if(e.tag===4)return h(4,[...t._1,...e._1],e._2);u()}if(t.tag===2){if(e.tag===0)return h(4,e._1,ne(t._1));if(e.tag===2)return h(2,n=>{let r=t._1(n),o=e._1(n);return()=>(r(),o())});if(e.tag===1)return h(1,n=>{let r=e._1(n);return o=>{let a=ne(t._1)(n)(o),i=r(o);return()=>(a(),i())}});if(e.tag===3)return h(3,e._1,n=>{let r=t._1(n),o=e._2(n);return()=>(r(),o())});if(e.tag===4)return h(4,e._1,n=>{let r=e._2(n);return o=>{let a=ne(t._1)(n)(o),i=r(o);return()=>(a(),i())}});u()}if(t.tag===1){if(e.tag===0)return h(4,e._1,t._1);if(e.tag===2)return h(1,n=>{let r=t._1(n);return o=>{let a=r(o),i=ne(e._1)(n)(o);return()=>(a(),i())}});if(e.tag===1)return h(1,n=>{let r=t._1(n),o=e._1(n);return a=>{let i=r(a),s=o(a);return()=>(i(),s())}});if(e.tag===3)return h(4,e._1,n=>{let r=t._1(n);return o=>{let a=r(o),i=ne(e._2)(n)(o);return()=>(a(),i())}});if(e.tag===4)return h(4,e._1,n=>{let r=t._1(n),o=e._2(n);return a=>{let i=r(a),s=o(a);return()=>(i(),s())}});u()}if(t.tag===3){if(e.tag===0)return h(3,[...t._1,...e._1],t._2);if(e.tag===2)return h(3,t._1,n=>{let r=t._2(n),o=e._1(n);return()=>(r(),o())});if(e.tag===1)return h(4,t._1,n=>{let r=e._1(n);return o=>{let a=ne(t._2)(n)(o),i=r(o);return()=>(a(),i())}});if(e.tag===3)return h(3,[...t._1,...e._1],n=>{let r=t._2(n),o=e._2(n);return()=>(r(),o())});if(e.tag===4)return h(4,[...t._1,...e._1],n=>{let r=e._2(n);return o=>{let a=ne(t._2)(n)(o),i=r(o);return()=>(a(),i())}});u()}if(t.tag===4){if(e.tag===0)return h(4,[...t._1,...e._1],t._2);if(e.tag===2)return h(4,t._1,n=>{let r=t._2(n);return o=>{let a=r(o),i=ne(e._1)(n)(o);return()=>(a(),i())}});if(e.tag===1)return h(4,t._1,n=>{let r=t._2(n),o=e._1(n);return a=>{let i=r(a),s=o(a);return()=>(i(),s())}});if(e.tag===3)return h(4,[...t._1,...e._1],n=>{let r=t._2(n);return o=>{let a=r(o),i=ne(e._2)(n)(o);return()=>(a(),i())}});if(e.tag===4)return h(4,[...t._1,...e._1],n=>{let r=t._2(n),o=e._2(n);return a=>{let i=r(a),s=o(a);return()=>(i(),s())}})}u()},Functor0:()=>z};var Va=t=>{let e=t,n=!0,r;for(;n;){let o=e;if(o.tag===4){e=h(1,o._2);continue}if(o.tag===3){e=h(2,o._2);continue}if(o.tag===2){let a=Hs(o._1);n=!1,r=()=>{let i=a();return{poll:h(2,i.event),unsubscribe:i.unsubscribe}};continue}if(o.tag===1){let a=Xs(o._1);n=!1,r=()=>{let i=a();return{poll:h(1,i.poll),unsubscribe:i.unsubscribe}};continue}if(o.tag===0){n=!1,r=()=>({poll:h(0,[]),unsubscribe:()=>{}});continue}u()}return r};var $n=()=>{let t=he();return{poll:Va(h(2,t.event))().poll,push:t.push}},Vf={apply:t=>e=>t.tag===2&&e.tag===2?h(2,so.apply(t._1)(e._1)):h(1,Bf(yr(t))(yr(e))),Functor0:()=>z};var _r={pure:t=>h(0,[t]),Apply0:()=>Vf};var mo=(t,e)=>({tag:t,_1:e}),jf=t=>e=>n=>{let r=ot.compare(t)(n),o=(()=>{if(r===0)return n;if(r===2||r===1)return t;u()})(),a=ot.compare(e)(o);if(a===0||a===2)return e;if(a===1)return o;u()},Gf=t=>e=>{let n=ot.compare(t)(e);if(n===0||n===2)return t;if(n===1)return e;u()},Jf=Oe(xn)(te);var za=(t,e)=>e.pushIx(t),Qf=t=>t.value.bound();var Ga=(t,e)=>{let n=[],a={value:{owner:{value:()=>0},extent:{value:()=>0},bound:t,pushAnchor:i=>{}}};return n.push({ix:()=>0,pushIx:i=>{},position:h(0,[]),end:a}),{children:n,bump:e}},po=(t,e)=>{let n=Tn(e),r=t.end.value,o=r.owner.value,a=o(),i=t.ix(),s=r.extent.value,d=s();return a===i&&d===(n-1|0)},ud=t=>{let e=t.end,n=t.ix,o=e.value.owner.value,a=o(),i=n();return a!==i},Wn=(t,e)=>e[t],Yf=t=>{let e=Tn(t);return Wn(e-1|0,t)},od=(t,e,n)=>{let r=n.children,o=po(e,r);if(t!==o){let i=Yf(r).end.value,s=i.owner.value;if(s()===0)return n.bump($);let f=i.bound();return n.bump(m(1,f))}},sd=(t,e)=>{let n=t(),o=Wn(n-1|0,e).end.value,a=o.extent.value;return a()<n&&(o.extent.value=t),o},hr=(t,e,n,r)=>{for(let o of Qn(t,e))n(o,r[o])},ja=(t,e,n)=>{let r=Tn(n);return hr(t,r,e,n)},Kf=(t,e)=>{let n=Tn(e),r=jf(1)(n)((()=>{if(t.tag===0)return n;if(t.tag===1)return 1+t._1|0;u()})()),o={value:r},a=wn(),i=()=>o.value,d={value:sd(i,e)},f={ix:i,pushIx:c=>(o.value=c,a.push(c-1|0)()),position:fo.alt(z.map(c=>-1+c|0)(h(1,Wa(o))))(h(2,a.event)),end:d};return er(r)(0)([f])(e)(),ja(r+1|0,za,e),f},ad=(t,e)=>{let r=t.end.value,o=t.ix(),i=Wn(o-1|0,e).end.value,s=r.extent.value,d=s(),f=i.owner.value,c=f();if((o-c|0)>(d-o|0)||c===0)return i.extent.value=s,hr(o,d+1|0,(g,y)=>{let E=y.end;E.value=i},e);let p=i.bound();return r.pushAnchor(p),r.owner.value=f,hr(c,o+1|0,(g,y)=>{let E=y.end;E.value=r},e)},id=(t,e,n)=>{if(!ud(e))return e.end.value.pushAnchor(t);let o=e.end.value,a=o.owner.value,i=a(),s=o.extent.value,d=s(),f=e.ix(),c=Wn(f-1|0,n);if((f-i|0)>(d-f|0)||i===0){let I={value:e.ix},R={value:s},w=t;hr(f,d+1|0,(Y,It)=>{let oe=It.end;oe.value={owner:I,extent:R,bound:()=>w,pushAnchor:N=>{w=N}}},n),o.extent.value=c.ix;return}let p={value:a},g={value:c.ix},E=o.bound();return hr(i,f,(I,R)=>{let w=R.end;w.value={owner:p,extent:g,bound:()=>E,pushAnchor:Y=>{E=Y}}},n),o.owner.value=e.ix,o.pushAnchor(t)},Zf=(t,e)=>{let n=t.ix();return Wn(n-1|0,e).end.value.bound()},Ja=(t,e)=>{let n=e.children,r=Kf(t,n),o=r.ix,a=i=>{if(i.tag===0){let s=po(r,n);return ad(r,n),od(s,r,e)}if(i.tag===1){let s=i._1;return id(s,r,n),po(r,n)?e.bump(i):void 0}u()};return{begin:()=>Zf(r,n),end:(()=>{let i=r.end;return()=>Qf(i)})(),position:r.position,sendTo:i=>{let s=i+1|0,d=$,f=po(r,n),c=o();if(!ud(r)){let oe=r.end.value.bound();d=m(1,oe),ad(r,n)}let g=r.end.value,y=c-1|0,E=g.extent.value,I=E();if(c===I){let It=Wn(y,n);g.extent.value=It.ix}let R=er(c)(1)([])(n)();er(s)(0)(R)(n)(),ja(Gf(c)(s),za,n);let w=sd(r.ix,n);r.end.value=w;let Y=d;return Jf(It=>()=>id(It,r,n))(Y)(),od(f,r,e)},remove:()=>{a($);let i=o();return r.pushIx(-1),er(i)(1)([])(n)(),ja(i,za,n)},bump:a}},Qa=(t,e)=>{let n=-1,r=$,o=$,a=$;return{end:()=>{let i=a;if(i.tag===1)return i._1;if(i.tag===0){let s=o;if(s.tag===1)return s._1;if(s.tag===0)return t()}u()},region:()=>{let i=r,s=(()=>{if(i.tag===0){let f=n=1+n|0,c=o,p=Ga((()=>{if(c.tag===1){let g=c._1;return()=>g}if(c.tag===0)return t;u()})(),g=>{if(f===n)return a=g,g.tag===0?e(o):e(g)});return r=m(1,p),p}if(i.tag===1)return i._1;u()})();return Ja($,s)},element:i=>{let s=r;return(()=>{if(s.tag===0)return!1;if(s.tag===1)return!0;u()})()&&(r=$,a=$,n=1+n|0),o=m(1,i),e(m(1,i))}}},go=t=>Qa(()=>mo(0,t),e=>{});var cd=t=>t;var Ya=t=>e=>(n,r)=>{let o=$n();return e(_(o.push,fo.alt(h(0,[t]))(o.poll)))(n,r)};var qn=t=>e=>n=>{let r=n(!0),o=n(!1),a=i=>{if(i.tag===2){let s=i._1;return()=>{let d=Ia(s,o);t.addEffectToDisposalQueue(d)}}if(i.tag===0){let s=i._1;return()=>Ne(s,r)}if(i.tag===1)return()=>{let s=he(),d=r,f=Ia(i._1(s.event),c=>d(c));t.addEffectToDisposalQueue(f),s.push(cd)(),d=o};if(i.tag===3){let s=i._2,d=a(h(0,i._1));return()=>(d(),a(h(2,s))())}if(i.tag===4){let s=i._2,d=a(h(0,i._1));return()=>(d(),a(h(1,s))())}u()};return a(e)};var On=(t,e,n)=>{let r=[];return{signalDisposalQueueShouldBeTriggered:h(1,va.once(yr(e))),ancestry:t,region:n,addEffectToDisposalQueue:o=>{r.push(o)},triggerDisposalQueueEffects:()=>{let o=r.length;for(let a of Qn(0,o))r[(o-1|0)-a|0]()}}},Xf={append:t=>e=>(n,r)=>{let o=n.ancestry;r.initializeFixedRendering(o);let a=On(ro(0)(n.ancestry),n.signalDisposalQueueShouldBeTriggered,n.region);return t(a,r),e({...n,ancestry:ro(1)(n.ancestry)},r)}},br=t=>qn(t)(t.signalDisposalQueueShouldBeTriggered)(e=>n=>t.triggerDisposalQueueEffects())(),tp=t=>(e,n)=>{let r=e.ancestry,o=(()=>{if(t.tag===0){let i=Qt(t._1);return n.makeText(r,i)}if(t.tag===2)return n.makeText(r,$);if(t.tag===1)return n.makeText(r,$);if(t.tag===3){let i=Qt(t._1);return n.makeText(r,i)}if(t.tag===4){let i=Qt(t._1);return n.makeText(r,i)}u()})();n.initializeTextRendering(e.ancestry,o),t.tag===0||n.markTextAsImpure(r),qn(e)((()=>{if(t.tag===0)return h(0,[]);if(t.tag===2)return h(2,t._1);if(t.tag===1)return h(1,t._1);if(t.tag===3)return h(2,t._2);if(t.tag===4)return h(1,t._2);u()})())(i=>s=>(i?n.setText:n.dynamicDOMInterpret().setText)(s,o))();let a=e.region.end();return n.attachText(o,a),e.region.element(mo(2,o)),e.addEffectToDisposalQueue(Ea(e.ancestry)?()=>{}:()=>n.removeText(o)),br(e)},b=t=>tp(h(0,[t])),ep=t=>e=>n=>(r,o)=>{let a=r.ancestry;o.initializeDynRendering(a);let i=r.region.region(),s=Ga(i.begin,i.bump),d=r.ancestry,f=-1;return qn(r)(t)(c=>p=>{let g=p._1,y=p._2,E=c?o:o.dynamicDOMInterpret(),I=Ja(g,s),R=Qa(I.begin,I.bump),w=!0,Y=$n(),It=$n(),oe=$n(),yt=f=1+f|0,zt=On(Ms(yt)(d),oe.poll,R);qn(zt)(Ba([e.sendTo(y),Y.poll]))(pe=>Me=>{let me=I.begin;if(!w){let jo=me(),Ae=I.end();I.sendTo(Me);let vt=I.begin();return E.beamRegion(jo,Ae,vt)}})(),qn(zt)(h(1,va.once(yr(Ba([z.map(pe=>{})(e.remove(y)),z.map(pe=>{})(It.poll),r.signalDisposalQueueShouldBeTriggered])))))(pe=>Me=>{if(!w)return w=!0,oe.push()(),I.remove()})(),n({value:y,position:I.position,remove:It.push(),sendTo:Y.push})(zt,E),w=!1})(),br(r)},ld=t=>ep(z.map(e=>_(m(1,0),e))(t));var Ka={mempty:(t,e)=>br(t),Semigroup0:()=>Xf},Ge=t=>(e,n)=>{let r=e.ancestry,o=e.signalDisposalQueueShouldBeTriggered,a=e.region,i=On(r,o,a),s=-1;return n.initializeFixedRendering(e.ancestry),Ne(t,d=>{let c=s=1+s|0;return d({...i,ancestry:ro(c)(i.ancestry)},n)}),br(e)},C=t=>e=>n=>r=>(o,a)=>{let i=t.tag===1?m(1,t._1):$;if(!a.isBoring(o.ancestry)){let s=a.makeElement(o.ancestry,i,e),d=o.region.end();o.region.element(mo(1,s)),a.initializeElementRendering(o.ancestry,s),Ne(n,p=>{if(p.tag!==0){let g=o.ancestry;a.markElementAsImpure(g)}return qn(o)(p)(g=>{let y=g?a:a.dynamicDOMInterpret();return E=>{let I=o.ancestry;return E(I,s,y)}})()});let f=go(s),c=-1;return Ne(r,p=>{let y=c=1+c|0,E=On(bs(y)(o.ancestry),o.signalDisposalQueueShouldBeTriggered,f);return p(E,a)}),a.attachElement(s,d),o.addEffectToDisposalQueue(Ea(o.ancestry)?()=>{}:()=>a.removeElement(s)),br(o)}},$d={sendTo:t=>h(0,[]),remove:t=>h(0,[])};var fd=(t,e)=>t.addEffectToDisposalQueue(e);var pd=t=>e=>(n,r)=>{let o=Va(t)();return fd(n,o.unsubscribe),e(o.poll)(n,r)};var md=t=>e=>(n,r)=>{let o=!1,a=X,i=he(),s=he(),d=rd.sample(t)(i.event)(c=>{if(o)return s.push(c)();a=G(1,c,a)});i.push(cd)();let f=a;return o=!0,fd(n,d),e((()=>{if(f.tag===1)return h(3,[f._1],s.event);if(f.tag===0)return h(2,s.event);u()})())(n,r)};var Mr=Yn.compose(t=>()=>(t(),!0));var gd=t=>C($)("i")([])([b(t)]);var Er=t=>C($)("h2")([])([b(t)]);var rp=t=>()=>t.map(e=>(n,r,o)=>(o.markElementAsImpure(n),o.setCb("@self@",Mr(e),r))),Za=t=>{let e=rp(t.Apply0().Functor0())();return()=>n=>e(t.pure(n))};var xr=function(){var t={},e="Pure",n="Throw",r="Catch",o="Sync",a="Async",i="Bind",s="Bracket",d="Fork",f="Sequential",c="Map",p="Apply",g="Alt",y="Cons",E="Resume",I="Release",R="Finalizer",w="Finalized",Y="Forked",It="Fiber",oe="Thunk";function N(F,j,ft,Q){this.tag=F,this._1=j,this._2=ft,this._3=Q}function yt(F){var j=function(ft,Q,k){return new N(F,ft,Q,k)};return j.tag=F,j}function zt(F){return new N(e,void 0)}function pe(F){try{F()}catch(j){setTimeout(function(){throw j},0)}}function Me(F,j,ft){try{return j(ft())}catch(Q){return F(Q)}}function me(F,j,ft){try{return j(ft)()}catch(Q){return ft(F(Q))(),zt}}var Se=function(){var F=1024,j=0,ft=0,Q=new Array(F),k=!1;function T(){var J;for(k=!0;j!==0;)j--,J=Q[ft],Q[ft]=void 0,ft=(ft+1)%F,J();k=!1}return{isDraining:function(){return k},enqueue:function(J){var W,ct;j===F&&(ct=k,T(),k=ct),Q[(ft+j)%F]=J,j++,k||T()}}}();function jo(F){var j={},ft=0,Q=0;return{register:function(k){var T=ft++;k.onComplete({rethrow:!0,handler:function(J){return function(){Q--,delete j[T]}}})(),j[T]=k,Q++},isEmpty:function(){return Q===0},killAll:function(k,T){return function(){if(Q===0)return T();var J=0,W={};function ct(K){W[K]=j[K].kill(k,function(_t){return function(){delete W[K],J--,F.isLeft(_t)&&F.fromLeft(_t)&&setTimeout(function(){throw F.fromLeft(_t)},0),J===0&&T()}})()}for(var Nt in j)j.hasOwnProperty(Nt)&&(J++,ct(Nt));return j={},ft=0,Q=0,function(K){return new N(o,function(){for(var _t in W)W.hasOwnProperty(_t)&&W[_t]()})}}}}}var Ae=0,vt=1,Rr=2,Wr=3,qr=4,Kt=5,Gn=6;function Go(F,j,ft){var Q=0,k=Ae,T=ft,J=null,W=null,ct=null,Nt=null,K=null,_t=0,Ze=0,ae=null,Le=!0;function we(P){for(var S,H,B;;)switch(S=null,H=null,B=null,k){case Rr:k=vt;try{T=ct(T),Nt===null?ct=null:(ct=Nt._1,Nt=Nt._2)}catch(wt){k=Kt,J=F.left(wt),T=null}break;case Wr:F.isLeft(T)?(k=Kt,J=T,T=null):ct===null?k=Kt:(k=Rr,T=F.fromRight(T));break;case vt:switch(T.tag){case i:ct&&(Nt=new N(y,ct,Nt)),ct=T._2,k=vt,T=T._1;break;case e:ct===null?(k=Kt,T=F.right(T._1)):(k=Rr,T=T._1);break;case o:k=Wr,T=Me(F.left,F.right,T._1);break;case a:k=qr,T=me(F.left,T._1,function(wt){return function(){Q===P&&(Q++,Se.enqueue(function(){Q===P+1&&(k=Wr,T=wt,we(Q))}))}});return;case n:k=Kt,J=F.left(T._1),T=null;break;case r:ct===null?K=new N(y,T,K,W):K=new N(y,T,new N(y,new N(E,ct,Nt),K,W),W),ct=null,Nt=null,k=vt,T=T._1;break;case s:_t++,ct===null?K=new N(y,T,K,W):K=new N(y,T,new N(y,new N(E,ct,Nt),K,W),W),ct=null,Nt=null,k=vt,T=T._1;break;case d:k=Wr,S=Go(F,j,T._2),j&&j.register(S),T._1&&S.run(),T=F.right(S);break;case f:k=vt,T=el(F,j,T._1);break}break;case Kt:if(ct=null,Nt=null,K===null)k=Gn,T=W||J||T;else switch(S=K._3,B=K._1,K=K._2,B.tag){case r:W&&W!==S&&_t===0?k=Kt:J&&(k=vt,T=B._2(F.fromLeft(J)),J=null);break;case E:W&&W!==S&&_t===0||J?k=Kt:(ct=B._1,Nt=B._2,k=Rr,T=F.fromRight(T));break;case s:_t--,J===null&&(H=F.fromRight(T),K=new N(y,new N(I,B._2,H),K,S),(W===S||_t>0)&&(k=vt,T=B._3(H)));break;case I:K=new N(y,new N(w,T,J),K,W),k=vt,W&&W!==S&&_t===0?T=B._1.killed(F.fromLeft(W))(B._2):J?T=B._1.failed(F.fromLeft(J))(B._2):T=B._1.completed(F.fromRight(T))(B._2),J=null,_t++;break;case R:_t++,K=new N(y,new N(w,T,J),K,W),k=vt,T=B._1;break;case w:_t--,k=Kt,T=B._1,J=B._2;break}break;case Gn:for(var mt in ae)ae.hasOwnProperty(mt)&&(Le=Le&&ae[mt].rethrow,pe(ae[mt].handler(T)));ae=null,W&&J?setTimeout(function(){throw F.fromLeft(J)},0):F.isLeft(T)&&Le&&setTimeout(function(){if(Le)throw F.fromLeft(T)},0);return;case Ae:k=vt;break;case qr:return}}function pt(P){return function(){if(k===Gn)return Le=Le&&P.rethrow,P.handler(T)(),function(){};var S=Ze++;return ae=ae||{},ae[S]=P,function(){ae!==null&&delete ae[S]}}}function L(P,S){return function(){if(k===Gn)return S(F.right(void 0))(),function(){};var H=pt({rethrow:!1,handler:function(){return S(F.right(void 0))}})();switch(k){case Ae:W=F.left(P),k=Gn,T=W,we(Q);break;case qr:W===null&&(W=F.left(P)),_t===0&&(k===qr&&(K=new N(y,new N(R,T(P)),K,W)),k=Kt,T=null,J=null,we(++Q));break;default:W===null&&(W=F.left(P)),_t===0&&(k=Kt,T=null,J=null)}return H}}function q(P){return function(){var S=pt({rethrow:!1,handler:P})();return k===Ae&&we(Q),S}}return{kill:L,join:q,onComplete:pt,isSuspended:function(){return k===Ae},run:function(){k===Ae&&(Se.isDraining()?we(Q):Se.enqueue(function(){we(Q)}))}}}function tl(F,j,ft,Q){var k=0,T={},J=0,W={},ct=new Error("[ParAff] Early exit"),Nt=null,K=t;function _t(pt,L,q){var P=L,S=null,H=null,B=0,mt={},wt,Jn;t:for(;;)switch(wt=null,P.tag){case Y:if(P._3===t&&(wt=T[P._1],mt[B++]=wt.kill(pt,function(nl){return function(){B--,B===0&&q(nl)()}})),S===null)break t;P=S._2,H===null?S=null:(S=H._1,H=H._2);break;case c:P=P._2;break;case p:case g:S&&(H=new N(y,S,H)),S=P,P=P._1;break}if(B===0)q(F.right(void 0))();else for(Jn=0,wt=B;Jn<wt;Jn++)mt[Jn]=mt[Jn]();return mt}function Ze(pt,L,q){var P,S,H,B,mt,wt;for(F.isLeft(pt)?(P=pt,S=null):(S=pt,P=null);;){if(H=null,B=null,mt=null,wt=null,Nt!==null)return;if(L===null){Q(P||S)();return}if(L._3!==t)return;switch(L.tag){case c:P===null?(L._3=F.right(L._1(F.fromRight(S))),S=L._3):L._3=P;break;case p:if(H=L._1._3,B=L._2._3,P){if(L._3=P,mt=!0,wt=J++,W[wt]=_t(ct,P===H?L._2:L._1,function(){return function(){delete W[wt],mt?mt=!1:q===null?Ze(P,null,null):Ze(P,q._1,q._2)}}),mt){mt=!1;return}}else{if(H===t||B===t)return;S=F.right(F.fromRight(H)(F.fromRight(B))),L._3=S}break;case g:if(H=L._1._3,B=L._2._3,H===t&&F.isLeft(B)||B===t&&F.isLeft(H))return;if(H!==t&&F.isLeft(H)&&B!==t&&F.isLeft(B))P=S===H?B:H,S=null,L._3=P;else if(L._3=S,mt=!0,wt=J++,W[wt]=_t(ct,S===H?L._2:L._1,function(){return function(){delete W[wt],mt?mt=!1:q===null?Ze(S,null,null):Ze(S,q._1,q._2)}}),mt){mt=!1;return}break}q===null?L=null:(L=q._1,q=q._2)}}function ae(pt){return function(L){return function(){delete T[pt._1],pt._3=L,Ze(L,pt._2._1,pt._2._2)}}}function Le(){var pt=vt,L=ft,q=null,P=null,S,H;t:for(;;)switch(S=null,H=null,pt){case vt:switch(L.tag){case c:q&&(P=new N(y,q,P)),q=new N(c,L._1,t,t),L=L._2;break;case p:q&&(P=new N(y,q,P)),q=new N(p,t,L._2,t),L=L._1;break;case g:q&&(P=new N(y,q,P)),q=new N(g,t,L._2,t),L=L._1;break;default:H=k++,pt=Kt,S=L,L=new N(Y,H,new N(y,q,P),t),S=Go(F,j,S),S.onComplete({rethrow:!1,handler:ae(L)})(),T[H]=S,j&&j.register(S)}break;case Kt:if(q===null)break t;q._1===t?(q._1=L,pt=vt,L=q._2,q._2=t):(q._2=L,L=q,P===null?q=null:(q=P._1,P=P._2))}for(K=L,H=0;H<k;H++)T[H].run()}function we(pt,L){Nt=F.left(pt);var q;for(var P in W)if(W.hasOwnProperty(P)){q=W[P];for(P in q)q.hasOwnProperty(P)&&q[P]()}W=null;var S=_t(pt,K,L);return function(H){return new N(a,function(B){return function(){for(var mt in S)S.hasOwnProperty(mt)&&S[mt]();return zt}})}}return Le(),function(pt){return new N(a,function(L){return function(){return we(pt,L)}})}}function el(F,j,ft){return new N(a,function(Q){return function(){return tl(F,j,ft,Q)}})}return N.EMPTY=t,N.Pure=yt(e),N.Throw=yt(n),N.Catch=yt(r),N.Sync=yt(o),N.Async=yt(a),N.Bind=yt(i),N.Bracket=yt(s),N.Fork=yt(d),N.Seq=yt(f),N.ParMap=yt(c),N.ParApply=yt(p),N.ParAlt=yt(g),N.Fiber=Go,N.Supervisor=jo,N.Scheduler=Se,N.nonCanceler=zt,N}(),ap=xr.Pure,ip=xr.Throw;var yd=xr.Sync;var up=xr.Async;var sp=xr.Seq;function Xa(t){return t.target}function _d(t){return function(e){return function(){e.checked=t}}}function hd(t){return function(e){return function(){e.disabled=t}}}function bd(t){return function(){return t.value}}function Md(t){return function(e){return function(){e.value=t}}}function xd(t){return function(e){return function(){e.disabled=t}}}var mp=Ue(De)(te);var gp=t=>e=>n=>{let r=t.map(o=>a=>mp((()=>{let i=tt(Xa(a),$,A);if(i.tag===1)return e.fromEventTarget(i._1);if(i.tag===0)return $;u()})())(i=>{let s=e.value(i);return()=>{let d=s();return o(d)()}}));return o=>n(r(o))},Dp=t=>gp(t)({fromEventTarget:dt("HTMLInputElement"),value:bd}),Cd=t=>{let e=Dp(t.Apply0().Functor0());return n=>{let r=e(n);return o=>r(t.pure(o))}};var yp=t=>e=>{let n=t.map(jt);return r=>e(n(r))},Fd=t=>{let e=yp(t.Apply0().Functor0());return n=>{let r=e(n);return o=>r(t.pure(o))}};var Id=t=>t.map(e=>(n,r,o)=>(o.markElementAsImpure(n),o.setCb("input",Mr(e),r)));var Nd=t=>t.map(e=>(n,r,o)=>(o.markElementAsImpure(n),o.setCb("click",Mr(e),r)));var bp=t=>e=>md(e)(n=>pd(n)(r=>ld(n)({...$d,remove:o=>z.map(a=>{})(r)})(o=>t(o.value)))),ti=t=>e=>bp(e)(t);var ei=new WeakMap,Pd=(t,e,n)=>{var r=ei.get(n);r!=null?r[t]=e:ei.set(n,{[t]:e})},ni=(t,e)=>{var n=ei.get(e);if(n==null)return null;var r=n[t]??null;return n[t]=void 0,r},Sd=t=>document.createElement(t),ri=(t,e)=>e.after.apply(e,t),Ad=(t,e)=>e.prepend.apply(e,t),Ld=(t,e)=>document.createElementNS(t,e),wd=t=>document.createTextNode(t),Rd=()=>document.createDocumentFragment(),Wd=(t,e)=>e.textContent=t,qd=(t,e,n,r)=>r.addEventListener(t,e,n),oi=(t,e,n,r)=>r.removeEventListener(t,e,n),Od=t=>t;function Tr(t){return function(e){return t===e}}function ai(t){return function(){return t.remove()}}var yo=function(t){return function(e){return e[t]}},Rp=yo("namespaceURI"),Wp=yo("prefix"),uN=yo("localName"),sN=yo("tagName");function _o(t){return function(e){return function(n){return function(){n.setAttribute(t,e)}}}}function ii(t){return function(e){return function(){e.removeAttribute(t)}}}var $e=function(t){return function(e){return function(){return e[t]}}};var UN=$e("baseURI"),Op=$e("ownerDocument"),Ud=$e("parentNode"),Up=$e("parentElement");var HN=$e("childNodes"),si=$e("firstChild"),Hp=$e("lastChild"),Hd=$e("previousSibling"),Un=$e("nextSibling"),vp=$e("nodeValue");var vN=$e("textContent");function Bd(t){return function(e){return function(){e.disabled=t}}}function Vd(t){return function(e){return function(){e.disabled=t}}}function zd(t){return function(e){return function(){e.disabled=t}}}function jd(t){return function(e){return function(){e.disabled=t}}}function Gd(t){return function(e){return function(){e.disabled=t}}}function Jd(t){return function(e){return function(){e.disabled=t}}}function Qd(t){return function(e){return function(){e.disabled=t}}}function Yd(t){return function(e){return function(){e.value=t}}}var Zd=Ue(De)(te),Kd=Oe(De)(te);var bo=(t,e)=>{let n=ni(t,e);return Zd(tt(n,$,A))(r=>()=>oi(t,r,!1,e))(),ii(t)(e)()},di=(t,e)=>Wd(t,e),Mo=(t,e,n)=>{if(t==="@self@"){e(n)();return}let r=ni(t,n);Zd(tt(r,$,A))(a=>()=>oi(t,a,!1,n))();let o=Od(a=>e(a)());return qd(t,o,!1,n),Pd(t,o,n)},Eo=t=>ai(t)(),xo=t=>ai(t)(),ci=(t,e)=>{let n=(()=>{if(e.tag===0)return"";if(e.tag===1)return e._1;u()})();return wd(n)},li=(t,e,n)=>{if(e.tag===0)return Sd(n);if(e.tag===1){let r=e._1;return Ld(r,n)}u()},Yp=t=>n=>{let r=n,o=!0,a;for(;o;){let i=r;if(i.tag===0){o=!1,a=$;continue}if(i.tag===1){let s=i._1.e(t);if(s.tag===1){o=!1,a=m(1,{f:i._1.f,e:s._1});continue}}if(i.tag===1){r=i._2;continue}u()}return a},Kp=G(1,{e:dt("HTMLButtonElement"),f:Bd},G(1,{e:dt("HTMLInputElement"),f:hd},G(1,{e:dt("HTMLFieldSetElement"),f:Vd},G(1,{e:dt("HTMLKeygenElement"),f:zd},G(1,{e:dt("HTMLLinkElement"),f:jd},G(1,{e:dt("HTMLOptGroupElement"),f:Gd},G(1,{e:dt("HTMLOptionElement"),f:Jd},G(1,{e:dt("HTMLSelectElement"),f:xd},G(1,{e:dt("HTMLTextAreaElement"),f:Qd},X))))))))),$i=(t,e,n)=>{let r=o=>{let a=i=>{let s=d=>{if(t==="disabled"){let f=Yp(n)(Kp);if(f.tag===1)return f._1.f(e==="true")(f._1.e)}return _o(t)(e)(n)};if(t==="checked"){let d=ln($,A,"HTMLInputElement",n);if(d.tag===1)return _d(e==="true")(d._1)}return s(!0)};if(t==="value"){let i=ln($,A,"HTMLTextAreaElement",n);if(i.tag===1)return Yd(e)(i._1)}return a(!0)};if(t==="value"){let o=ln($,A,"HTMLInputElement",n);if(o.tag===1)return Md(e)(o._1)()}return r(!0)()},To=()=>{let t=Rd();return _(0,t)},ho=(t,e)=>{if(e.tag===0){let n=e._1;return Ad(t,n)}if(e.tag===1){let n=e._1;return ri(t,n)}if(e.tag===2){let n=e._1;return ri(t,n)}u()},fi=(t,e)=>ho([t],e),Co=(t,e,n)=>{if(e.tag===0)return;if(t.tag===0){let d=si(t._1),f=Kd(p=>{let g=(()=>{if(e.tag===1||e.tag===2)return e._1;u()})();return()=>{let y=[],E=m(1,p);for(;(()=>{let I=E;if(I.tag===0)return!1;if(I.tag===1)return!0;u()})();){let I=E,R=(()=>{if(I.tag===1)return I._1;u()})();if(y.push(R),Tr(R)(g)){E=$;continue}let w=Un(R)();E=tt(w,$,A)}return ho(y,n)}}),c=d();return f(tt(c,$,A))()}let r=(()=>{if(e.tag===1||e.tag===2)return e._1;u()})(),o=(()=>{if(t.tag===1||t.tag===2)return t._1;u()})();if(Tr(o)(r))return;let a=Un(o),i=Kd(d=>()=>{let f=[],c=m(1,d);for(;(()=>{let p=c;if(p.tag===0)return!1;if(p.tag===1)return!0;u()})();){let p=c,g=(()=>{if(p.tag===1)return p._1;u()})();if(f.push(g),Tr(g)(r)){c=$;continue}let y=Un(g)();c=tt(y,$,A)}return ho(f,n)}),s=a();return i(tt(s,$,A))()},pi=(t,e)=>ho([t],e);var Cr={dynamicDOMInterpret:t=>Cr,portalDOMInterpret:t=>Cr,isBoring:t=>!1,makeElement:li,attachElement:pi,initializeElementRendering:(t,e)=>{},initializeTextRendering:(t,e)=>{},markElementAsImpure:t=>{},setProp:$i,setCb:Mo,unsetAttribute:bo,removeElement:xo,makeText:ci,attachText:fi,setText:di,removeText:Eo,markTextAsImpure:t=>{},beamRegion:Co,initializePortalRendering:t=>{},markPortalAsRendered:t=>{},bufferPortal:To,initializeDynRendering:t=>{},initializeFixedRendering:t=>{}};var Fo=function(t){return function(e){return function(){return e[t]}}},xS=Fo("children"),rm=Fo("firstElementChild"),om=Fo("lastElementChild"),TS=Fo("childElementCount");function gi(t){return t.body}var ec=t=>e=>()=>{let n=$n(),r=go(t),o=On(hs,n.poll,r);return e(o,Cr),n.push()};var nc=t=>e=>()=>{let n=La(),r=Qs(n)(),o=gi(r),a=tt(o,$,A),i=We(Re("Could not find element"));return a.tag===1?t(a._1)(e)():i()};function Di(t){return function(e){return function(){return setTimeout(e,t)}}}var rc=t=>{let e=Qt(t);if(e.tag===1)return e._1;u()};var x=(t,e)=>({_1:t,_2:e});var oc=t=>{let e=t.Semiring0(),n={add:r=>o=>x(e.add(r._1)(o._1),e.add(r._2)(o._2)),zero:x(e.zero,e.zero),mul:r=>o=>x(e.mul(r._1)(o._1),e.mul(r._2)(o._2)),one:x(e.one,e.one)};return{sub:r=>o=>x(t.sub(r._1)(o._1),t.sub(r._2)(o._2)),Semiring0:()=>n}};var yi=t=>{let e=t.Eq0(),n={eq:r=>o=>e.eq(r._1)(o._1)&&e.eq(r._2)(o._2)};return{compare:r=>o=>{let a=t.compare(r._1)(o._1);return a===0?et:a===1?nt:t.compare(r._2)(o._2)},Eq0:()=>n}};var _i=t=>t._1;var ac=t=>e=>n=>Ct(r=>o=>({min:x((()=>{let a=t.compare(r.min._1)(o._1);if(a===0||a===2)return r.min._1;if(a===1)return o._1;u()})(),(()=>{let a=t.compare(r.min._2)(o._2);if(a===0||a===2)return r.min._2;if(a===1)return o._2;u()})()),max:x((()=>{let a=t.compare(r.max._1)(o._1);if(a===0)return o._1;if(a===2||a===1)return r.max._1;u()})(),(()=>{let a=t.compare(r.max._2)(o._2);if(a===0)return o._2;if(a===2||a===1)return r.max._2;u()})())}))({min:(()=>{if(0<n.length)return n[0];u()})(),max:(()=>{if(0<n.length)return n[0];u()})()})((()=>{let r=ar(o=>$,o=>a=>m(1,a),n);if(r.tag===1)return r._1;u()})());var aL=Number.POSITIVE_INFINITY,iL=Number.NEGATIVE_INFINITY;function ke(t){return t.charCodeAt(0)}function Fr(t){return String.fromCharCode(t)}var ym=typeof Array.from=="function",_m=typeof Symbol<"u"&&Symbol!=null&&typeof Symbol.iterator<"u"&&typeof String.prototype[Symbol.iterator]=="function",hm=typeof String.prototype.fromCodePoint=="function",bm=typeof String.prototype.codePointAt=="function",ic=function(t){return bm?function(e){return e.codePointAt(0)}:t};var uc=function(t){return hm?String.fromCodePoint:t},sc=function(t){return function(e){return _m?function(n){for(var r="",o=n[Symbol.iterator](),a=0;a<e;++a){var i=o.next();if(i.done)return r;r+=i.value}return r}:t(e)}},dc=function(t){return function(e){return ym?function(n){return Array.from(n,e)}:t}};var No=t=>{let e=rn(t);if(e===0)return $;if(e===1)return m(1,{head:ke(nn(0)(t)),tail:""});let n=ke(nn(1)(t)),r=ke(nn(0)(t));return 55296<=r&&r<=56319&&56320<=n&&n<=57343?m(1,{head:(((r-55296|0)*1024|0)+(n-56320|0)|0)+65536|0,tail:Be(2)(t)}):m(1,{head:r,tail:Be(1)(t)})},xm=t=>{let e=No(t);return e.tag===1?m(1,_(e._1.head,e._1.tail)):$},Tm=t=>an.unfoldr(xm)(t),Cm=t=>{let e=ke(nn(0)(t));if(55296<=e&&e<=56319&&rn(t)>1){let n=ke(nn(1)(t));if(56320<=n&&n<=57343)return(((e-55296|0)*1024|0)+(n-56320|0)|0)+65536|0}return e},Fm=ic(Cm),ko=dc(Tm)(Fm);var bi=t=>U(t>=0&&t<=65535?Fr(t):t<0?"\0":"\uFFFF"),Im=t=>t<=65535?bi(t):bi(Jo(t-65536|0,1024)+55296|0)+bi(lr(t-65536|0)(1024)+56320|0);var Nm=uc(Im),cc=t=>e=>{if(t<1)return"";let n=No(e);return n.tag===1?Nm(n._1.head)+cc(t-1|0)(n._1.tail):e},lc=sc(cc);var $c=function(t){return function(e){return function(n){return function(r){try{return e(new RegExp(n,r))}catch(o){return t(o.message)}}}}};var fc=function(t){return function(e){return function(n){return function(r){var o=r.match(n);if(o==null||o.length===0)return e;for(var a=0;a<o.length;a++)o[a]=o[a]==null?e:t(o[a]);return t(o)}}}};var Mi=t=>e=>$c(Zn)(ge)(t)((e.global?"g":"")+(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.dotAll?"s":"")+(e.sticky?"y":"")+(e.unicode?"u":""));var Ei=fc(A)($);var xi={global:!1,ignoreCase:!1,multiline:!1,dotAll:!1,sticky:!1,unicode:!1};var gc={map:t=>e=>n=>{let r=e(n);if(r.tag===0)return l(0,r._1);if(r.tag===1)return l(1,{result:t(r._1.result),suffix:r._1.suffix});u()}};var Je={apply:t=>e=>n=>{let r=t(n);return(()=>{if(r.tag===0){let o=r._1;return a=>l(0,o)}if(r.tag===1){let o=r._1;return a=>a(o)}u()})()(o=>{let a=e(o.suffix);return(()=>{if(a.tag===0){let i=a._1;return s=>l(0,i)}if(a.tag===1){let i=a._1;return s=>s(i)}u()})()(i=>l(1,{result:o.result(i.result),suffix:i.suffix}))})},Functor0:()=>gc},Sm={bind:t=>e=>n=>{let r=t(n);return(()=>{if(r.tag===0){let o=r._1;return a=>l(0,o)}if(r.tag===1){let o=r._1;return a=>a(o)}u()})()(o=>e(o.result)(o.suffix))},Apply0:()=>Je};var Dc={pure:t=>e=>l(1,{result:t,suffix:e}),Apply0:()=>Je},Am={Applicative0:()=>Dc,Bind1:()=>Sm},yc={tailRecM:t=>e=>n=>{let r=i=>{let s=t(i.state)(i.str);if(s.tag===0)return l(0,s._1);if(s.tag===1)return l(1,(()=>{if(s._1.result.tag===0)return Tt(0,{state:s._1.result._1,str:s._1.suffix});if(s._1.result.tag===1)return Tt(1,{result:s._1.result._1,suffix:s._1.suffix});u()})());u()},o=i=>{if(i.tag===0)return Tt(1,l(0,i._1));if(i.tag===1){if(i._1.tag===0)return Tt(0,r(i._1._1));if(i._1.tag===1)return Tt(1,l(1,i._1._1))}u()};return(i=>{let s=i,d=!0,f;for(;d;){let c=s;if(c.tag===0){s=o(c._1);continue}if(c.tag===1){d=!1,f=c._1;continue}u()}return f})(o(r({state:e,str:n})))},Monad0:()=>Am};var Hn={alt:t=>e=>n=>{let r=t(n);return r.tag===0?n.position===r._1.pos?e(n):l(0,{error:r._1.error,pos:r._1.pos}):r},Functor0:()=>gc},Ir={empty:t=>l(0,{pos:t.position,error:"No alternative"}),Alt0:()=>Hn},_c={Applicative0:()=>Dc,Plus1:()=>Ir};var Lm=t=>e=>n=>{let r=t(n);return(()=>{if(r.tag===0){let o=r._1;return a=>l(0,o)}if(r.tag===1){let o=r._1;return a=>a(o)}u()})()(o=>{let a=o.result,i=e(o.suffix),s=(()=>{if(i.tag===0){let d=i._1;return f=>l(0,d)}if(i.tag===1){let d=i._1;return f=>f(d)}u()})()(d=>{let f=Ti(t)(e)(d.suffix);return(()=>{if(f.tag===0){let c=f._1;return p=>l(0,c)}if(f.tag===1){let c=f._1;return p=>p(c)}u()})()(c=>l(1,{result:ue(a,c.result),suffix:c.suffix}))});return s.tag===0?o.suffix.position===s._1.pos?l(1,{result:ue(a,X),suffix:o.suffix}):l(0,{error:s._1.error,pos:s._1.pos}):s})},Ti=t=>e=>n=>{let r=Lm(t)(e)(n),o=(()=>{if(r.tag===0)return l(0,r._1);if(r.tag===1)return l(1,{result:G(1,r._1.result._1,r._1.result._2),suffix:r._1.suffix});u()})();if(o.tag===0){if(n.position===o._1.pos){let a=e(n),i=(()=>{if(a.tag===0)return l(0,a._1);if(a.tag===1)return l(1,{result:X,suffix:a._1.suffix});u()})();return i.tag===0?n.position===i._1.pos?l(1,{result:X,suffix:n}):l(0,{error:i._1.error,pos:i._1.pos}):i}return l(0,{error:o._1.error,pos:o._1.pos})}return o};var Ci=(()=>{let t=xs(yc)(_c);return e=>t(n=>{let r=e(n);return r.tag===1?n.position<r._1.suffix.position?l(1,r._1):l(0,{pos:n.position,error:"Consumed no input."}):r})})(),Nr=t=>Je.apply(e=>{let n=t(e);if(n.tag===0)return l(0,n._1);if(n.tag===1)return l(1,{result:(()=>{let r=n._1.result;return o=>ue(r,o)})(),suffix:n._1.suffix});u()})(Ci(t));var hc=t=>{let e=ts(0)(t.substring);if(e.tag===1)return l(1,{result:e._1,suffix:{substring:Be(1)(t.substring),position:t.position+1|0}});if(e.tag===0)return l(0,{pos:t.position,error:"Unexpected EOF"});u()};var bc=t=>{let e=Mi("^("+t+")")(xi);if(e.tag===0){let n="StringParser.String.regex': illegal regex "+t;return r=>l(0,{pos:r.position,error:n})}if(e.tag===1){let n=e._1;return r=>{let o=Ei(n)(r.substring);return o.tag===1&&(()=>{if(0<o._1.length)return o._1[0].tag===1;u()})()?l(1,{result:(()=>{if(0<o._1.length)return o._1[0]._1;u()})(),suffix:{substring:Be(rn(lc(ko((()=>{if(0<o._1.length)return o._1[0]._1;u()})()).length)(r.substring)))(r.substring),position:r.position+ko((()=>{if(0<o._1.length)return o._1[0]._1;u()})()).length|0}}):l(0,{pos:r.position,error:"no match"})}}u()};var Ao=t=>0<ko(t.substring).length?l(0,{pos:t.position,error:"Expected EOF"}):l(1,{result:void 0,suffix:t});var Mc=t=>{let e=hc(t),n=(()=>{if(e.tag===0){let r=e._1;return o=>l(0,r)}if(e.tag===1){let r=e._1;return o=>o(r)}u()})()(r=>r.result>="0"&&r.result<="9"?l(1,{result:r.result,suffix:r.suffix}):l(0,{pos:r.suffix.position,error:"Character "+bn(r.result)+" is not a digit"}));return n.tag===0?l(0,{pos:t.position,error:n._1.error}):n},Wm=t=>{let e=No(t.substring);if(e.tag===0)return l(0,{pos:t.position,error:"Unexpected EOF"});if(e.tag===1)return l(1,{result:e._1.head,suffix:{substring:e._1.tail,position:t.position+1|0}});u()};var qm=t=>{let e=Wm(t);if(e.tag===0)return l(0,e._1);if(e.tag===1)return e._1.result>=0&&e._1.result<=65535?e._1.result>65535?l(0,{pos:e._1.suffix.position,error:"Code point "+gt(e._1.result)+" is not a character"}):l(1,{result:Fr(e._1.result),suffix:e._1.suffix}):l(0,{pos:e._1.suffix.position,error:"Code point "+gt(e._1.result)+" is not a character"});u()},Om=t=>e=>{let n=qm(e),r=(()=>{if(n.tag===0){let o=n._1;return a=>l(0,o)}if(n.tag===1){let o=n._1;return a=>a(o)}u()})()(o=>t(o.result)?l(1,{result:o.result,suffix:o.suffix}):l(0,{pos:o.suffix.position,error:"Character "+bn(o.result)+" did not satisfy predicate"}));return r.tag===0?l(0,{pos:e.position,error:r._1.error}):r},St=t=>{let e=Om(r=>r===t),n="Could not match character "+bn(t);return r=>{let o=e(r);return o.tag===0?r.position===o._1.pos?l(0,{pos:r.position,error:n}):l(0,{error:o._1.error,pos:o._1.pos}):o}};var ce=t=>t,pn=(t,e,n)=>({tag:t,_1:e,_2:n}),bt=(t,e)=>({tag:t,_1:e}),Yt=(t,e)=>({tag:t,_1:e}),Um=ht(Hn.alt)(Ir.empty);var vn=ce(0),Lo=ce(1),Bn=ce(2),Qe=ce(3),Et=ce(4),xc=ce(5),de=ce(6),Ye=ce(7),Vn=ce(8),wo=ce(9),zn=ce(10),Hm=ce(11);var Ec=bt(3);var Pe=t=>{if(t.tag===0){if(t._1===0)return"1";if(t._1===1)return"2";if(t._1===2)return"3";if(t._1===3)return"4";if(t._1===4)return"5";if(t._1===5)return"6";if(t._1===6)return"7";if(t._1===7)return"8";if(t._1===8)return"9";if(t._1===9)return U("a");if(t._1===10)return U("b");if(t._1===11)return U("b");u()}if(t.tag===1)return(()=>{if(t._1===0)return"1";if(t._1===1)return"2";if(t._1===2)return"3";if(t._1===3)return"4";if(t._1===4)return"5";if(t._1===5)return"6";if(t._1===6)return"7";if(t._1===7)return"8";if(t._1===8)return"9";if(t._1===9)return U("a");if(t._1===10)return U("b");if(t._1===11)return U("b");u()})()+U(".");if(t.tag===2)return(()=>{if(t._1===0)return"1";if(t._1===1)return"2";if(t._1===2)return"3";if(t._1===3)return"4";if(t._1===4)return"5";if(t._1===5)return"6";if(t._1===6)return"7";if(t._1===7)return"8";if(t._1===8)return"9";if(t._1===9)return U("a");if(t._1===10)return U("b");if(t._1===11)return U("b");u()})()+U("z");if(t.tag===3)return U("*");u()},kr=t=>{if(t.tag===0)return[t._1];if(t.tag===1)return ee([t._1.doubleThreat._1,t._1.doubleThreat._2])(t._1.destination);u()};var Pr=(()=>{let t=St("a"),e=St("b"),n=St("c");return r=>{let o=Mc(r),a=(()=>{if(o.tag===0){let i=o._1;return s=>l(0,i)}if(o.tag===1){let i=o._1;return s=>s(i)}u()})()(i=>i.result==="1"?l(1,{result:vn,suffix:i.suffix}):i.result==="2"?l(1,{result:Lo,suffix:i.suffix}):i.result==="3"?l(1,{result:Bn,suffix:i.suffix}):i.result==="4"?l(1,{result:Qe,suffix:i.suffix}):i.result==="5"?l(1,{result:Et,suffix:i.suffix}):i.result==="6"?l(1,{result:xc,suffix:i.suffix}):i.result==="7"?l(1,{result:de,suffix:i.suffix}):i.result==="8"?l(1,{result:Ye,suffix:i.suffix}):i.result==="9"?l(1,{result:Vn,suffix:i.suffix}):l(0,{pos:i.suffix.position,error:"only the digits 1-9 can be used"}));if(a.tag===0){if(r.position===a._1.pos){let i=t(r),s=(()=>{if(i.tag===0)return l(0,i._1);if(i.tag===1)return l(1,{result:wo,suffix:i._1.suffix});u()})();if(s.tag===0){if(r.position===s._1.pos){let d=e(r),f=(()=>{if(d.tag===0)return l(0,d._1);if(d.tag===1)return l(1,{result:zn,suffix:d._1.suffix});u()})();if(f.tag===0){if(r.position===f._1.pos){let c=n(r);if(c.tag===0)return l(0,c._1);if(c.tag===1)return l(1,{result:Hm,suffix:c._1.suffix});u()}return l(0,{error:f._1.error,pos:f._1.pos})}return f}return l(0,{error:s._1.error,pos:s._1.pos})}return s}return l(0,{error:a._1.error,pos:a._1.pos})}return a}})(),At=t=>{if(t===0)return Yt(0,x(0,1));if(t===1)return Yt(1,{destination:x(1,1),doubleThreat:_(x(0,1),x(1,0))});if(t===2)return Yt(0,x(1,0));if(t===3)return Yt(1,{destination:x(2,-1),doubleThreat:_(x(1,0),x(1,-1))});if(t===4)return Yt(0,x(1,-1));if(t===5)return Yt(1,{destination:x(1,-2),doubleThreat:_(x(1,-1),x(0,-1))});if(t===6)return Yt(0,x(0,-1));if(t===7)return Yt(1,{destination:x(-1,-1),doubleThreat:_(x(0,-1),x(-1,0))});if(t===8)return Yt(0,x(-1,0));if(t===9)return Yt(1,{destination:x(-2,1),doubleThreat:_(x(-1,0),x(-1,1))});if(t===10)return Yt(0,x(-1,1));if(t===11)return Yt(1,{destination:x(-1,2),doubleThreat:_(x(0,1),x(-1,1))});u()},Tc=t=>{let e=Ct(n=>{let r=n._2,o=n._1;return a=>(()=>{if(a.tag===1||a.tag===2||a.tag===3)return!0;if(a.tag===0)return!1;u()})()?_(ee(o)([...r,a]),[]):_(o,ee(r)(a))})(_([],[]))(t);return e._2.length>0?ee(e._1)(e._2):e._1},Cc=(()=>{let t=Zr.Foldable0().foldr,e=Nr((()=>{let n=St("*");return r=>{let o=Pr(r),a=(()=>{if(o.tag===0){let s=o._1;return d=>l(0,s)}if(o.tag===1){let s=o._1;return d=>d(s)}u()})()(s=>{let d=St("z"),f=St(".")(s.suffix),c=(()=>{if(f.tag===0)return l(0,f._1);if(f.tag===1)return l(1,{result:bt(1,s.result),suffix:f._1.suffix});u()})();if(c.tag===0){if(s.suffix.position===c._1.pos){let p=d(s.suffix);if(p.tag===0)return l(0,p._1);if(p.tag===1)return l(1,{result:bt(2,s.result),suffix:p._1.suffix});u()}return l(0,{error:c._1.error,pos:c._1.pos})}return c}),i=a.tag===0?l(0,{pos:r.position,error:a._1.error}):a;if(i.tag===0){if(r.position===i._1.pos){let s=Pr(r),d=(()=>{if(s.tag===0)return l(0,s._1);if(s.tag===1)return l(1,{result:bt(0,s._1.result),suffix:s._1.suffix});u()})();if(d.tag===0){if(r.position===d._1.pos){let f=n(r);if(f.tag===0)return l(0,f._1);if(f.tag===1)return l(1,{result:Ec,suffix:f._1.suffix});u()}return l(0,{error:d._1.error,pos:d._1.pos})}return d}return l(0,{error:i._1.error,pos:i._1.pos})}return i}})());return n=>{let r=e(n),o=(()=>{if(r.tag===0)return l(0,r._1);if(r.tag===1)return l(1,{result:qt(t,r._1.result),suffix:r._1.suffix});u()})();return(()=>{if(o.tag===0){let a=o._1;return i=>l(0,a)}if(o.tag===1){let a=o._1;return i=>i(a)}u()})()(a=>{let i=a.result;return Um([(()=>{let s=St("s"),d=O(c=>c.tag===0?bt(0,c._1===0?zn:c._1===1?wo:c._1===2?Vn:c._1===3?Ye:c._1===4?de:c._1===6?Et:c._1===7?Qe:c._1===8?Bn:c._1===9?Lo:c._1===10?vn:c._1):c.tag===1?bt(1,c._1===0?zn:c._1===1?wo:c._1===2?Vn:c._1===3?Ye:c._1===4?de:c._1===6?Et:c._1===7?Qe:c._1===8?Bn:c._1===9?Lo:c._1===10?vn:c._1):c.tag===2?bt(2,c._1===0?zn:c._1===1?wo:c._1===2?Vn:c._1===3?Ye:c._1===4?de:c._1===6?Et:c._1===7?Qe:c._1===8?Bn:c._1===9?Lo:c._1===10?vn:c._1):c)(i),f=(()=>{let c=Qt(i),p=(()=>{if(c.tag===1)return c._1;u()})();if(p.tag===1||p.tag===2||p.tag===3)return!0;if(p.tag===0)return!1;u()})()?[...i,...d]:[...ee(i)(Ec),...d];return c=>{let p=s(c);if(p.tag===0)return l(0,p._1);if(p.tag===1)return l(1,{result:f,suffix:p._1.suffix});u()}})(),s=>l(1,{result:i,suffix:s})])(a.suffix)})}})(),Lt=t=>e=>{if(e.tag===0)return Yt(0,x(t._1+e._1._1|0,t._2+e._1._2|0));if(e.tag===1)return Yt(1,{destination:x(t._1+e._1.destination._1|0,t._2+e._1.destination._2|0),doubleThreat:_(x(t._1+e._1.doubleThreat._1._1|0,t._2+e._1.doubleThreat._1._2|0),x(t._1+e._1.doubleThreat._2._1|0,t._2+e._1.doubleThreat._2._2|0))});u()},mn=t=>{let e=t.MonadThrow0(),n=e.Monad0(),r=n.Bind1(),o=n.Applicative0();return a=>{let i=r.Apply0().Functor0().map(Jt),s=Ct(d=>f=>r.bind(d)(c=>{if(f.tag===0){let p=Lt(c._1)(At(f._1)),g=(()=>{if(p.tag===0)return p._1;if(p.tag===1)return p._1.destination;u()})();return g._2>=1?o.pure(_(g,[...c._2,...kr(p)])):e.throwError(pn(0,f._1))}if(f.tag===1){if(c._1._2===1)return o.pure(_(c._1,c._2));if(c._1._2<1)return e.throwError(pn(0,f._1));let p=y=>{let E=Lt(c._1)(At(y));return r.bind(mn(t)((()=>{if(E.tag===0)return E._1;if(E.tag===1)return E._1.destination;u()})())([bt(1,y)]))(I=>o.pure(_(a,[...c._2,...(()=>{if(E.tag===0)return[];if(E.tag===1)return[E._1.doubleThreat._1,E._1.doubleThreat._2];u()})(),...I])))},g=y=>r.bind(mn(t)((()=>{let E=Lt(c._1)(At(y));if(E.tag===0)return E._1;if(E.tag===1)return E._1.destination;u()})())([bt(1,y)]))(E=>o.pure(_(a,[...c._2,...E])));return f._1===3?c._1._2===2?o.pure(_(a,[...c._2,...kr(Lt(c._1)(At(Et)))])):p(Qe):f._1===4?g(Et):f._1===5?c._1._2===2?o.pure(_(a,[...c._2,...kr(Lt(c._1)(At(Et))),...kr(Lt(c._1)(At(de)))])):p(xc):f._1===6?g(de):f._1===7?c._1._2===2?o.pure(_(a,[...c._2,...kr(Lt(c._1)(At(de)))])):p(Ye):e.throwError(pn(1,f))}if(f.tag===2){let p=c._1._2,g=(y,E,I)=>{if(p===4){let w=Lt(c._1)(At(E));return r.bind(mn(t)((()=>{if(w.tag===0)return w._1;if(w.tag===1)return w._1.destination;u()})())([bt(1,I)]))(Y=>o.pure(_(a,[...c._2,...(()=>{if(w.tag===0)return[];if(w.tag===1)return[w._1.doubleThreat._1,w._1.doubleThreat._2];u()})(),...Y])))}let R=Lt(c._1)(At(y));return r.bind(mn(t)((()=>{if(R.tag===0)return R._1;if(R.tag===1)return R._1.destination;u()})())([bt(2,y)]))(w=>o.pure(_(a,[...c._2,...(()=>{if(R.tag===0)return[];if(R.tag===1)return[R._1.doubleThreat._1,R._1.doubleThreat._2];u()})(),...w])))};return p<4?e.throwError(pn(2,f,p)):f._1===3?g(Qe,Et,Qe):f._1===4?g(Et,Et,Qe):f._1===6?g(de,de,Ye):f._1===7?g(Ye,de,Ye):e.throwError(pn(1,f))}if(f.tag===3)return o.pure(_(a,c._2));u()}))(o.pure(_(a,[a])));return d=>i(s(d))}},Ro=t=>{let e=t.MonadThrow0().Monad0().Bind1().Apply0().Functor0().map(rc),n=mn(t);return r=>o=>e(n(r)(o))};var Ke=Ro(Xe);var Fc=t=>{let e=Ke(t._1)([bt(1,Et)]);return O(n=>x(n,0))((()=>{let n=Ke(t._2)([bt(1,Et)]);return ve((()=>{if(e.tag===1)return e._1._1;u()})(),(()=>{if(n.tag===1)return n._1._1+1|0;u()})())})())},Ic=t=>{let e=Ke(t._1)([bt(1,Et)]);return[(()=>{if(e.tag===1)return e._1;u()})(),(()=>{let n=Ke(t._2)([bt(1,Et)]);if(n.tag===1)return n._1;u()})()]},vm=t=>e=>{let n=ot.compare((()=>{let r=Ke(t)([bt(1,Et)]);if(r.tag===1)return r._1._1;u()})())((()=>{let r=Ke(e)([bt(1,Et)]);if(r.tag===1)return r._1._1;u()})());return n===2?ot.compare((()=>{let r=Ke(t)([bt(1,Et)]);if(r.tag===1)return r._1._1;u()})())((()=>{let r=Ke(e)([bt(1,Et)]);if(r.tag===1)return r._1._1;u()})()):n},Ni=t=>e=>{let n=ur(vm)([t,e]);return _((()=>{if(0<n.length)return n[0];u()})(),(()=>{let r=Qt(n);if(r.tag===1)return r._1;u()})())};var Sr={foldlRecordRowList:t=>e=>n=>r=>e};var fe=t=>()=>e=>n=>({foldlRecordRowList:r=>o=>a=>i=>n.foldlRecordRowList(r)(e.foldingWithIndex(r)(V)(o)(Xt(t.reflectSymbol(V))(i)))(V)(i)});var Qm=t=>t;var ki={mapRecordWithIndexBuilder:t=>e=>Qm};var gn=t=>e=>n=>()=>()=>({mapRecordWithIndexBuilder:r=>o=>{let a=ys()()(t)(V)(e.mappingWithIndex(o)(V)),i=n.mapRecordWithIndexBuilder(V)(o);return s=>a(i(s))}});var Pi=()=>t=>({hmapWithIndex:(()=>{let e=t.mapRecordWithIndexBuilder(V);return n=>{let r=e(n);return o=>r(ha(o))}})()});var re=t=>({_1:t}),Km=t=>t,Ar=Km(0);var Dn=1/ma(.5235987755982988);var Si=t=>e=>x(t._1/Dn+2*(t._1/Dn)*on(e._1-1|0)+t._1/Dn*on(e._2-1|0),t._1+1.5*t._1*on(e._2-1|0)),Lr=t=>e=>{let n=e._1/2,r=e._1/Dn;if(t===0)return[x(0,e._1),x(r,n),x(r,-n),x(0,-e._1),x(-r,-n),x(-r,n)];if(t===1)return[x(e._1,0),x(n,r),x(-n,r),x(-e._1,0),x(-n,-r),x(n,-r)];u()};var Sc=parseInt,Ac=t=>e=>(console.info(t),e);var Xm=()=>({}),tg=()=>({}),Ai=t=>t,eg=tg(),ng=Xm(),Li=t=>()=>()=>({foldingWithIndex:e=>n=>r=>o=>a=>o(i=>r(s=>a(d=>Pn(t.reflectSymbol(n))(i)(s(d)))))}),wi=t=>()=>()=>()=>()=>({foldingWithIndex:e=>n=>r=>o=>_(a=>Pn(t.reflectSymbol(n))(o._1)(r._1(a)),a=>Pn(t.reflectSymbol(n))(o._2)(r._2(a)))}),wc=t=>e=>n=>r=>t.hfoldlWithIndex(eg)(le(Ai))(n)((()=>{let o=e.hfoldlWithIndex(ng)(_(Ai,Ai));return a=>{let i=o(a({}));return r(_(i._1({}),i._2({})))}})());var Rc=(()=>{let t=Zr.Foldable0().foldr;return e=>qt(t,e)})(),Ri=(()=>{let t=Ti((()=>{let e=St("*");return n=>{let r=e(n),o=(()=>{if(r.tag===0)return l(0,r._1);if(r.tag===1)return l(1,{result:!0,suffix:r._1.suffix});u()})();if(o.tag===0){if(n.position===o._1.pos){let i=Nr(Pr)(n),s=(()=>{if(i.tag===0)return l(0,i._1);if(i.tag===1){let d=Rc(i._1.result),f=St("^")(i._1.suffix);if(f.tag===0)return i._1.suffix.position===f._1.pos?l(1,{result:{reset:!1,connected:!1,moves:d},suffix:i._1.suffix}):l(0,{error:f._1.error,pos:f._1.pos});if(f.tag===1)return l(1,{result:{reset:!1,connected:!0,moves:d},suffix:f._1.suffix})}u()})();return s.tag===0?l(0,{pos:n.position,error:s._1.error}):s}return l(0,{pos:n.position,error:o._1.error})}let a=(()=>{if(o.tag===0){let i=o._1;return s=>l(0,i)}if(o.tag===1){let i=o._1;return s=>s(i)}u()})()(i=>{let s=Nr(Pr)(i.suffix);if(s.tag===0)return l(0,s._1);if(s.tag===1){let d=Rc(s._1.result),f=St("^")(s._1.suffix);if(f.tag===0)return s._1.suffix.position===f._1.pos?l(1,{result:{reset:i.result,connected:!1,moves:d},suffix:s._1.suffix}):l(0,{error:f._1.error,pos:f._1.pos});if(f.tag===1)return l(1,{result:{reset:i.result,connected:!0,moves:d},suffix:f._1.suffix})}u()});return a.tag===0?l(0,{pos:n.position,error:a._1.error}):a}})())(St(":"));return e=>{let n=t(e);if(n.tag===0)return l(0,n._1);if(n.tag===1)return l(1,{result:qt(se.foldr,n._1.result),suffix:n._1.suffix});u()}})(),Wc=(()=>{let t=bc("\\d+");return e=>{let n=t(e);if(n.tag===0)return l(0,n._1);if(n.tag===1){let r=Sc(n._1.result),o=St(":"),a=Je.apply(i=>{let s=o(i);if(s.tag===0)return l(0,s._1);if(s.tag===1)return l(1,{result:Ee,suffix:s._1.suffix});u()})(Ri)(n._1.suffix);return a.tag===0?n._1.suffix.position===a._1.pos?l(1,{result:{height:r,stoneMoves:[]},suffix:n._1.suffix}):l(0,{error:a._1.error,pos:a._1.pos}):(()=>{if(a.tag===0){let i=a._1;return s=>l(0,i)}if(a.tag===1){let i=a._1;return s=>s(i)}u()})()(i=>l(1,{result:{height:r,stoneMoves:i.result},suffix:i.suffix}))}u()}})();var qc=t=>{let e=t.MonadThrow0(),n=e.Monad0(),r=n.Applicative0();return o=>Ct(a=>i=>n.Bind1().bind(a)(s=>{let d=Lt(s)(At(i)),f=(()=>{if(d.tag===0)return d._1;if(d.tag===1)return d._1.destination;u()})();return f._2>=1?r.pure(f):e.throwError(pn(0,i))}))(r.pure(o))},Oc=t=>{let e=t.MonadThrow0().Monad0(),n=e.Bind1(),r=qc(t),o=e.Applicative0();return a=>i=>Ct(s=>d=>{let f=d.moves,c=d.reset;return n.bind(s)(p=>n.bind(c?r(a)(f):r((()=>{let g=Qt(p);if(g.tag===0)return a;if(g.tag===1)return g._1;u()})())(f))(g=>o.pure(ee(p)(g))))})(o.pure([]))(i)},Uc=t=>{let e=t.MonadThrow0().Monad0(),n=e.Bind1(),r=qc(t),o=e.Applicative0();return a=>i=>Ct(s=>d=>{let f=d.connected,c=d.moves,p=d.reset;return n.bind(s)(g=>n.bind(p?r(a)(c):r((()=>{let y=Qt(g);if(y.tag===1)return y._1.pos;u()})())(c))(y=>o.pure(ee(g)({connected:f,pos:y}))))})(o.pure([{connected:!0,pos:a}]))(i)};var ag=()=>({}),ig=()=>({}),ug=(()=>{let t=z.map(e=>(n,r,o)=>o.setProp("id",e,r));return e=>t(h(0,[e]))})(),sg=(()=>{let t=z.map(e=>(n,r,o)=>o.setProp("href",e,r));return e=>t(h(0,[e]))})(),dg=ig(),cg=ag(),Wi=t=>e=>n=>r=>o=>C(m(1,"http://www.w3.org/2000/svg"))("svg")(n)([C(m(1,"http://www.w3.org/2000/svg"))("defs")([])(t.hfoldlWithIndex(cg)([])(r)),...o(e.hmapWithIndex(dg)(r))]),yn=t=>({foldingWithIndex:e=>n=>r=>o=>ee(r)(C(m(1,"http://www.w3.org/2000/svg"))("g")([ug(t.reflectSymbol(n)+"_typesafe")])([o]))}),_n=t=>({mappingWithIndex:e=>n=>r=>o=>C(m(1,"http://www.w3.org/2000/svg"))("use")([sg("#"+t.reflectSymbol(n)+"_typesafe"),...o])([])});function Hc(t){return function(){return t.focus()}}var hn=(t,e)=>({tag:t,_1:e}),vc=ht(Hn.alt)(Ir.empty),fg=Uc(Xe),pg=Oc(Xe),Bc=oc(fa).sub,mg=t=>e=>Ct(n=>r=>n.init?{init:!1,acc:r}:{init:!1,acc:n.acc+t+r})({init:!0,acc:""})(e).acc,gg=Fn.foldMap1(sr)(da),Dt=(()=>{let t=z.map(e=>(n,r,o)=>o.setProp("style",e,r));return e=>t(h(0,[e]))})(),Wo={reflectSymbol:()=>"connectedStone"},qo={reflectSymbol:()=>"disconnectedStone"},Oo={reflectSymbol:()=>"edgeCell"},Uo={reflectSymbol:()=>"emptyCell"},Ho={reflectSymbol:()=>"enemyStone"},Dg=Wi((()=>{let t=fe(Wo)()(yn(Wo))(fe(qo)()(yn(qo))(fe(Oo)()(yn(Oo))(fe(Uo)()(yn(Uo))(fe(Ho)()(yn(Ho))(Sr)))));return{hfoldlWithIndex:e=>n=>t.foldlRecordRowList(e)(n)(V)}})())(Pi()(gn(Wo)(_n(Wo))(gn(qo)(_n(qo))(gn(Oo)(_n(Oo))(gn(Uo)(_n(Uo))(gn(Ho)(_n(Ho))(ki)()())()())()())()())()())),Gc=(()=>{let t=z.map(e=>(n,r,o)=>o.setProp("width",e,r));return e=>t(h(0,[e]))})(),Jc=(()=>{let t=z.map(e=>(n,r,o)=>o.setProp("height",e,r));return e=>t(h(0,[e]))})(),Qc=(()=>{let t=z.map(e=>(n,r,o)=>o.setProp("viewBox",e,r));return e=>t(h(0,[e]))})(),Oi=(()=>{let t=z.map(e=>(n,r,o)=>o.setProp("transform",e,r));return e=>t(h(0,[e]))})(),Yc=(()=>{let t=z.map(e=>(n,r,o)=>o.setProp("preserveAspectRatio",e,r));return e=>t(h(0,[e]))})(),Ui=(()=>{let t=z.map(e=>(n,r,o)=>o.setProp("stroke-width",e,r));return e=>t(h(0,[e]))})(),Hi=(()=>{let t=z.map(e=>(n,r,o)=>o.setProp("stroke",e,r));return e=>t(h(0,[e]))})(),vi=(()=>{let t=z.map(e=>(n,r,o)=>o.setProp("points",e,r));return e=>t(h(0,[e]))})(),Bi=t=>e=>Ct(n=>r=>n.init?{init:!1,acc:r}:{init:!1,acc:n.acc+t+r})({init:!0,acc:""})(e).acc,Vi=(()=>{let t=z.map(e=>(n,r,o)=>o.setProp("class",e,r));return e=>t(h(0,[e]))})(),wr=(()=>{let t=z.map(e=>(n,r,o)=>o.setProp("fill",e,r));return e=>t(h(0,[e]))})(),vo=(()=>{let t=z.map(e=>(n,r,o)=>o.setProp("r",e,r));return e=>t(h(0,[e]))})(),Vc=(()=>{let t=Gt.foldMap((()=>{let e={append:n=>r=>n||r};return{mempty:!1,Semigroup0:()=>e}})());return e=>t(n=>e._1===n._1&&e._2===n._2)})(),zc=(()=>{let t=Gt.foldMap((()=>{let e={append:n=>r=>n||r};return{mempty:!1,Semigroup0:()=>e}})());return e=>t(n=>e._1===n._1&&e._2===n._2)})(),Bo={reflectSymbol:()=>"hex"},yg=Wi((()=>{let t=fe(Bo)()(yn(Bo))(Sr);return{hfoldlWithIndex:e=>n=>t.foldlRecordRowList(e)(n)(V)}})())(Pi()(gn(Bo)(_n(Bo))(ki)()())),_g=(()=>{let t=z.map(e=>(n,r,o)=>o.setProp("font-size",e,r));return e=>t(h(0,[e]))})(),hg=(()=>{let t=z.map(e=>(n,r,o)=>o.setProp("text-anchor",e,r));return e=>t(h(0,[e]))})(),bg=(()=>{let t=z.map(e=>(n,r,o)=>o.setProp("dominant-baseline",e,r));return e=>t(h(0,[e]))})(),Mg=Fd(_r),Eg=Nd(z),xt=(()=>{let t=z.map(e=>(n,r,o)=>o.setProp("class",e,r));return e=>t(h(0,[e]))})(),xg=Cd(_r),Tg=Id(z),Cg=(()=>{let t=z.map(e=>(n,r,o)=>o.setProp("spellcheck",e,r));return e=>t(h(0,[e]))})(),Fg=Za(_r)(),Vo={reflectSymbol:()=>"showInstructions"},zo={reflectSymbol:()=>"specStr"},Ig=mn(Xe),qi=Ro(Xe);var Kc=t=>e=>{let n=Si(t)(e);return"translate("+kt(n._1)+","+kt(n._2)+")"},Ng=t=>{let e=t.Apply0().Functor0().map(n=>(r,o,a)=>a.setProp("transform",n,o));return n=>r=>e(t.pure(Kc(n)(r)))},jn=Ng(_r),kg=t=>{let e=St("-"),n=Je.apply(i=>{let s=e(i);if(s.tag===0)return l(0,s._1);if(s.tag===1)return l(1,{result:Ee,suffix:s._1.suffix});u()})(Ao),r=i=>s=>{let d=Ao(s),f=d.tag===0?s.position===d._1.pos?n(s):l(0,{error:d._1.error,pos:d._1.pos}):d,c=(()=>{if(f.tag===0)return l(0,f._1);if(f.tag===1)return l(1,{result:i,suffix:f._1.suffix});u()})();return c.tag===0?l(0,{pos:s.position,error:c._1.error}):c},o=Wc({substring:t,position:0}),a=(()=>{if(o.tag===0){let i=o._1;return s=>l(0,i)}if(o.tag===1){let i=o._1;return s=>s(i)}u()})()(i=>{let s=i.result.height,d=i.result.stoneMoves;return vc([r({height:s,stoneMoves:d,carrierMoves:[],enemyMoves:[]}),(()=>{let f=St("-");return c=>{let p=f(c);return(()=>{if(p.tag===0){let g=p._1;return y=>l(0,g)}if(p.tag===1){let g=p._1;return y=>y(g)}u()})()(g=>{let y=Cc(g.suffix),E=(()=>{if(y.tag===0)return l(0,y._1);if(y.tag===1)return l(1,{result:qt(ht,y._1.result),suffix:y._1.suffix});u()})();return(()=>{if(E.tag===0){let I=E._1;return R=>l(0,I)}if(E.tag===1){let I=E._1;return R=>R(I)}u()})()(I=>{let R=I.result,w=vc([r([]),(()=>{let Y=St("-");return It=>{let oe=Y(It);return(()=>{if(oe.tag===0){let N=oe._1;return yt=>l(0,N)}if(oe.tag===1){let N=oe._1;return yt=>yt(N)}u()})()(N=>{let yt=Ri(N.suffix);return(()=>{if(yt.tag===0){let zt=yt._1;return pe=>l(0,zt)}if(yt.tag===1){let zt=yt._1;return pe=>pe(zt)}u()})()(zt=>{let pe=zt.result,Me=Ao(zt.suffix);return(()=>{if(Me.tag===0){let me=Me._1;return Se=>l(0,me)}if(Me.tag===1){let me=Me._1;return Se=>Se(me)}u()})()(me=>l(1,{result:pe,suffix:me.suffix}))})})}})()])(I.suffix);return(()=>{if(w.tag===0){let Y=w._1;return It=>l(0,Y)}if(w.tag===1){let Y=w._1;return It=>It(Y)}u()})()(Y=>l(1,{result:{height:s,stoneMoves:d,carrierMoves:R,enemyMoves:Y.result},suffix:Y.suffix}))})})}})()])(i.suffix)});if(a.tag===0)return l(0,hn(2,a._1));if(a.tag===1){let i=fg(x(1,a._1.result.height))(a._1.result.stoneMoves);if(i.tag===0)return l(0,hn(0,i._1));if(i.tag===1){let s=pg(x(1,a._1.result.height))(a._1.result.enemyMoves);if(s.tag===0)return l(0,hn(0,s._1));if(s.tag===1)return l(1,{stones:i._1,carrierMoves:a._1.result.carrierMoves,enemyStones:s._1})}}u()};var Pg=t=>Fn.foldl1(e=>n=>t(n)<t(e)?n:e);var Sg=t=>Fn.foldl1(e=>n=>t(n)>t(e)?n:e),Zc=t=>e=>n=>{let r=ac(or)(Kr)(gg(O(s=>O((()=>{let d=Si(t)(s);return f=>x(d._1+f._1,d._2+f._2)})())(Lr(Ar)(t)))(n))),o=x(.5*e,.5*Dn*e),a=Bc(r.min)(o),i=Bc(x(r.max._1+o._1,r.max._2+o._2))(a);return mg(" ")(O(kt)([a._1,a._2,i._1,i._2]))},Ag=t=>{let e=.9*(1/Dn),n=(r,o)=>C($)("div")([Dt("height: 70%; padding: 0 5%;")])([Dg([Gc("100%"),Jc("100%"),Qc(Zc(re(1))(.075)(r)),Oi("scale(1,-1)"),Yc("xMidYMin")])({emptyCell:C(m(1,"http://www.w3.org/2000/svg"))("polygon")([Ui("0.075"),Hi("black"),vi(Bi(" ")(O(a=>kt(a._1)+","+kt(a._2))(Lr(Ar)(re(1))))),Vi("c1")])([]),edgeCell:C(m(1,"http://www.w3.org/2000/svg"))("polygon")([Ui("0.075"),Hi("black"),wr("black"),vi(Bi(" ")(O(a=>kt(a._1)+","+kt(a._2))(Lr(Ar)(re(1)))))])([]),connectedStone:C(m(1,"http://www.w3.org/2000/svg"))("g")([])([C(m(1,"http://www.w3.org/2000/svg"))("circle")([wr("black"),vo(kt(e))])([]),C(m(1,"http://www.w3.org/2000/svg"))("circle")([wr("white"),vo(kt(.2*e))])([])]),disconnectedStone:C(m(1,"http://www.w3.org/2000/svg"))("circle")([wr("black"),vo(kt(e))])([]),enemyStone:C(m(1,"http://www.w3.org/2000/svg"))("g")([])([C(m(1,"http://www.w3.org/2000/svg"))("circle")([wr("white"),vo(kt(.975*e))])([])])})(o)]);return ti(t)(r=>{if(r.tag===1){if(r._1.mcarrier.tag===1){let o=r._1.mcarrier._1;return n([...o.cells,...Ic(o.endpoints),...O(a=>a.pos)(r._1.stones)],a=>[Ge(qt(ht,O(i=>a.emptyCell([jn(re(1))(i)]))(o.cells))),Ge(qt(ht,O(i=>a.edgeCell([jn(re(1))(i)]))(Fc(o.endpoints)))),Ge(qt(ht,O(i=>(i.connected?a.connectedStone:a.disconnectedStone)([jn(re(1))(i.pos)]))(r._1.stones))),Ge(O(i=>a.enemyStone([jn(re(1))(i)]))(r._1.enemyStones))])}if(r._1.mcarrier.tag===0)return n(O(o=>o.pos)(r._1.stones),o=>qt(ht,O(a=>(a.connected?o.connectedStone:o.disconnectedStone)([jn(re(1))(a.pos)]))(r._1.stones)));u()}if(r.tag===0)return C($)("div")([Dt(`
              height: 100%;
              display: flex;
              justify-content: center;
              align-items: center;
              font-size: 3em;
              width: min(80%, 1100px);
              `)])([C($)("span")([])((()=>{if(r._1.tag===0){if(r._1._1.tag===0)return[b("The move "),C($)("span")([Dt("color: #bf0000; font-weight: bold;")])([b(Pe(bt(0,r._1._1._1)))]),b(" takes you below the edge!")];if(r._1._1.tag===1)return r._1._1._1.tag===1?[C($)("span")([Dt("color: #bf0000; font-weight: bold;")])([b(Pe(r._1._1._1))]),b(" is an invalid move. The "),C($)("span")([Dt("color: #bf0000; font-weight: bold;")])([b(U("."))]),b(' means "continue this move untill you hit an edge", but '),C($)("span")([Dt("color: #bf0000; font-weight: bold;")])([b(Pe(r._1._1._1))]),b(" will never hit an edge!")]:r._1._1._1.tag===2?[C($)("span")([Dt("color: #bf0000; font-weight: bold;")])([b(Pe(r._1._1._1))]),b(" is an invalid move. The "),C($)("span")([Dt("color: #bf0000; font-weight: bold;")])([b(U("z"))]),b(' means "continue until I can take an adjacent step downwards into a ziggurat", but '),C($)("span")([Dt("color: #bf0000; font-weight: bold;")])([b(Pe(r._1._1._1))]),b(" will never hit an edge!")]:[C($)("span")([Dt("color: #bf0000; font-weight: bold;")])([b(Pe(r._1._1._1))]),b(" is an invalid move. The "),C($)("span")([Dt("color: #bf0000; font-weight: bold;")])([b(We(Re("something has gone horribly wrong"))()._1)]),b(" means "+We(Re("something has gone horribly wrong"))()._2+", but "),C($)("span")([Dt("color: #bf0000; font-weight: bold;")])([b(Pe(r._1._1._1))]),b(" will never hit an edge!")];if(r._1._1.tag===2)return[b("You're trying to use "),C($)("span")([Dt("color: #bf0000; font-weight: bold;")])([b(Pe(r._1._1._1))]),b(" on row "+gt(r._1._1._2)+", but "),C($)("span")([Dt("color: #bf0000; font-weight: bold;")])([b(U("z"))]),b(" only works on rows 4 and up.")];u()}if(r._1.tag===1)return[b("The carrier needs to be specified with 2 paths from the start to the edge, but you currently have "+gt(r._1._1)+"!")];if(r._1.tag===2)return[b(Ac(r._1._1)("Your template encoding is not valid."))];u()})())]);u()})},jc=t=>{let e=ir(o=>o._2===1,t.cells),n=Vc(t.endpoints._1)(e)&&Vc(t.endpoints._2)(e)&&!(t.endpoints._1._1===t.endpoints._2._1&&t.endpoints._1._2===t.endpoints._2._2)&&e.length>0?m(1,e):$,r=o=>a=>zc(o)(a)?a:r((()=>{let i=Lt(o)(At(zn));if(i.tag===0)return i._1;if(i.tag===1)return i._1.destination;u()})())(r((()=>{let i=Lt(o)(At(Vn));if(i.tag===0)return i._1;if(i.tag===1)return i._1.destination;u()})())(r((()=>{let i=Lt(o)(At(de));if(i.tag===0)return i._1;if(i.tag===1)return i._1.destination;u()})())(r((()=>{let i=Lt(o)(At(Et));if(i.tag===0)return i._1;if(i.tag===1)return i._1.destination;u()})())(r((()=>{let i=Lt(o)(At(Bn));if(i.tag===0)return i._1;if(i.tag===1)return i._1.destination;u()})())(r((()=>{let i=Lt(o)(At(vn));if(i.tag===0)return i._1;if(i.tag===1)return i._1.destination;u()})())([...a,o]))))));if(n.tag===1){let o=Pg(_i)(n._1),a=Sg(_i)(n._1),i=f=>{let c=f,p=!0,g;for(;p;){let y=c,E=x(o._1+y|0,o._2+0|0);if(!zc(E)(t.cells)){p=!1,g=m(1,E);continue}if(!(E._1===a._1&&E._2===a._2)){c=y+1|0;continue}p=!1,g=$}return g},s=O(f=>x(f,0))(ve(o._1,a._1)),d=i(1);if(d.tag===1){let f=ir(c=>c._2!==0,r(d._1)([...t.cells,...s]));return f.length>0?f:We(Re("something has gone very wrong"))()}if(d.tag===0)return t.cells;u()}if(n.tag===0)return t.cells;u()},Xc=(()=>{let t=nc(ec)(wc((()=>{let e=fe(Vo)()(Li(Vo)()())(fe(zo)()(Li(zo)()())(Sr));return{hfoldlWithIndex:n=>r=>e.foldlRecordRowList(n)(r)(V)}})())((()=>{let e=fe(Vo)()(wi(Vo)()()()())(fe(zo)()(wi(zo)()()()())(Sr));return{hfoldlWithIndex:n=>r=>e.foldlRecordRowList(n)(r)(V)}})())({specStr:Ya("7:78^:7-4434.7787.-5:9:77"),showInstructions:Ya(!1)})(e=>{let n=e._1;return C($)("div")([Dt(`
          height: 100vh;
          display: flex;
          justify-content: center;
          align-items: center;
          `)])([(()=>{let r=[_("*",x(0,0)),_("1",x(0,1)),_("2",x(1,1)),_("3",x(1,0)),_("4",x(2,-1)),_("5",x(1,-1)),_("6",x(1,-2)),_("7",x(0,-1)),_("8",x(-1,-1)),_("9",x(-1,0)),_(U("a"),x(-2,1)),_(U("b"),x(-1,1)),_(U("c"),x(-1,2))],o=C($)("div")([Dt("margin: 1em 0;")])([yg([Gc("250px"),Jc("250px"),Qc(Zc(re(1))(.1)(O(Jt)(r))),Oi("scale(1,-1)"),Yc("xMidYMin")])({hex:C(m(1,"http://www.w3.org/2000/svg"))("polygon")([Ui("0.1"),Hi("black"),vi(Bi(" ")(O(a=>kt(a._1)+","+kt(a._2))(Lr(Ar)(re(1))))),Vi("c1")])([])})(a=>[Ge(qt(ht,O(i=>a.hex([jn(re(1))(i)]))(O(Jt)(r)))),Ge(qt(ht,O(i=>C(m(1,"http://www.w3.org/2000/svg"))("text")([Vi("c2"),_g(".75"),hg("middle"),bg("middle"),Oi(Kc(re(1))(i._2)+" scale(1, -1)")])([b(i._1)]))(r)))])]);return ti(e._2.showInstructions)(a=>Ge([C($)("button")([Mg(Eg)(n.showInstructions(!a)),Dt(`
                  --size: 1.7em;
                  position: absolute;
                  top: 1em;
                  right: 1em;
                  z-index: 1;
                  border: none;
                  font-size: var(--size);
                  border-radius: var(--size);
                  width: var(--size);
                  height: var(--size);
                  cursor: pointer;
                  z-index: 3;
                  `+(a?"background: var(--color1); border: 1px solid;":""))])([b("?")]),a?C($)("div")([Dt(`
                    position: absolute;
                    top: 0;
                    left: 0;
                    display: flex;
                    justify-content: center;
                    align-items: center;
                    width: 100vw;
                    height: 100vh;
                    `)])([C($)("div")([Dt(`
                        background: var(--color1);
                        z-index: 2;
                        white-space: pre-wrap;
                        padding: 1em;
                        max-height: 80%;
                        max-width: 80%;
                        overflow: auto;
                        border-radius: 1em;
                        box-shadow: #0005 0 2px 4px;
                        font-size: 1.3em;
                        `)])([b("The central tool is the "),gd("clock move"),b(". for each of the numbers on the clock, there is a natural corresponding step one can take from a reference hexagon. Even numbers are bridges, and odd numbers are adjacent."),o,b("We use these, plus some shorthand to describe all the parts of a template:"),Er("Sections"),b("A template is specified by 2 or 3 sections, separated by "),C($)("span")([xt("c0")])([b(U("-"))]),b("s (hyphens)."),Er("Stones"),b("The stones section starts with a number that indicates the height of the anchor point. If it is a one-stone template, that's all you need, otherwise a "),C($)("span")([xt("c0")])([b(U(":"))]),b(" is placed after the anchor, and the other stones are specified as a colon-separated list of clock move sequences to get from where you are, to the next stone. To place a stone relative to the anchor instead of the last placed stone, begin the sequence with "),C($)("span")([xt("c0")])([b(U("*"))]),b(". To denote a stone as being connected to the opposite edge, end the sequence with "),C($)("span")([xt("c0")])([b(U("^"))]),b("."),Er("Carrier"),b("Carriers are specified with two clock move sequences, both starting from the anchor and ending at the edge. The two sequences describe the border of the carrier. Clock moves that correspond to bridges bring the whole bridge into the carrier. There are also three shorthand symbols:"),C($)("ol")([Dt("margin: 0;")])([C($)("li")([])([C($)("span")([xt("c0")])([b(U("."))]),b(": Continue this move until it forms a bridge to the edge.")]),C($)("li")([])([C($)("span")([xt("c0")])([b(U("z"))]),b(': Continue this move until it "drops to a ziggurat".'),C($)("ul")([Dt("padding-left: calc((var(--scale1) + 4) * 1ch);")])([C($)("li")([])([C($)("span")([xt("c0")])([b("4"+U("z"))]),b("/"),C($)("span")([xt("c0")])([b("5"+U("z"))]),b(" means "),C($)("span")([xt("c0")])([b("4")]),b("/"),C($)("span")([xt("c0")])([b("5")]),b(" until you get to row 4, then "),C($)("span")([xt("c0")])([b("545")])]),C($)("li")([])([C($)("span")([xt("c0")])([b("8"+U("z"))]),b("/"),C($)("span")([xt("c0")])([b("7"+U("z"))]),b(" means "),C($)("span")([xt("c0")])([b("8")]),b("/"),C($)("span")([xt("c0")])([b("7")]),b(" until you get to row 4, then "),C($)("span")([xt("c0")])([b("787")])])])]),C($)("li")([])([C($)("span")([xt("c0")])([b(U("s"))]),b(": Mirror the sequence.")])]),C($)("span")([xt("c0")])([b(U("."))]),b(" and "),C($)("span")([xt("c0")])([b(U("z"))]),b(" indicate the end of a sequence, so the next move starts back at the anchor. In the case where the first sequence ends without one of those markers, "),C($)("span")([xt("c0")])([b(U("*"))]),b(" is again used to set it back to the anchor (as I write this I see now that that's not strictly necessary, but I'll probably keep it in for readability)."),Er("Enemy Stones/Holes"),b("Enemy stones are specified the same way as stones, minus the initial anchor part and the "),C($)("span")([xt("c0")])([b(U("^"))]),b(" syntax. This section can be elided if there are no enemy stones in the template.")])]):Ka.mempty]))})(),C($)("div")([Dt(`
          position: absolute;
          top: 10px;
          z-index: 1;
          `)])([C($)("input")([Dt(`
              font-size: min(2rem, 4vh);
              border-radius: .25em;
              border: none;
              padding: .25em;
              min-width: 26ch;
              field-sizing: content;
              text-align: center;
              outline: none;
              `),z.map(r=>(o,a,i)=>i.setProp("value",r,a))(e._2.specStr),xg(Tg)(n.specStr),Cg("false"),Fg(r=>{let o=Di(0)(Hc(r));return()=>{o()}})])([])]),Ag(z.map(r=>{if(r==="")return l(1,{stones:[{connected:!0,pos:x(1,1)}],mcarrier:$,enemyStones:[]});let o=kg(r);return(()=>{if(o.tag===0){let a=o._1;return i=>l(0,a)}if(o.tag===1){let a=o._1;return i=>i(a)}u()})()(a=>{let i=a.carrierMoves.length>0?m(1,a.carrierMoves):$;if(i.tag===1){let s=i._1,d=(()=>{if(0<a.stones.length)return a.stones[0].pos;u()})(),f=Ig(d)(s),c=(()=>{if(f.tag===0)return l(0,hn(0,f._1));if(f.tag===1)return l(1,f._1);u()})();return(()=>{if(c.tag===0){let p=c._1;return g=>l(0,p)}if(c.tag===1){let p=c._1;return g=>g(p)}u()})()(p=>{let g=Tc(s);if(g.length===1){let y=qi(d)(g[0]),E=(()=>{if(y.tag===0){let I=y._1;return R=>l(0,I)}if(y.tag===1){let I=y._1;return R=>R(I)}u()})()(I=>l(1,Ni(d)(I)));if(E.tag===0)return l(0,hn(0,E._1));if(E.tag===1)return l(1,{stones:a.stones,mcarrier:m(1,{cells:jc({cells:Jr(yi(ot).compare)(p),endpoints:E._1}),endpoints:E._1}),enemyStones:a.enemyStones});u()}if(g.length===2){let y=g[1],E=qi(d)(g[0]),I=(()=>{if(E.tag===0){let R=E._1;return w=>l(0,R)}if(E.tag===1){let R=E._1;return w=>w(R)}u()})()(R=>{let w=qi(d)(y);return(()=>{if(w.tag===0){let Y=w._1;return It=>l(0,Y)}if(w.tag===1){let Y=w._1;return It=>It(Y)}u()})()(Y=>l(1,Ni(R)(Y)))});if(I.tag===0)return l(0,hn(0,I._1));if(I.tag===1)return l(1,{stones:a.stones,mcarrier:m(1,{cells:jc({cells:Jr(yi(ot).compare)(p),endpoints:I._1}),endpoints:I._1}),enemyStones:a.enemyStones});u()}return l(0,hn(1,g.length))})}if(i.tag===0)return l(1,{stones:a.stones,mcarrier:$,enemyStones:[]});u()})})(e._2.specStr))])}));return()=>{t()}})();Xc();})();
